"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
Object.defineProperty(exports, "__esModule", { value: true });
const fs = __importStar(require("fs"));
const os = __importStar(require("os"));
const path = __importStar(require("path"));
const provider_generator_1 = require("../../generator/provider-generator");
const codemaker_1 = require("codemaker");
// this is a workaround for a bug introduced in TS 3.9.x and seems to be unlikely to get fixed.
// Since jsii relies on TS < 4 at the moment we can't use newer TS versions which have this fixed (^4.1).
// see https://github.com/hashicorp/terraform-cdk/pull/1248 for more context
test("shard exports across multiple files to avoid generating files with more than a 1000 exports", async () => {
    const code = new codemaker_1.CodeMaker();
    const workdir = fs.mkdtempSync(path.join(os.tmpdir(), "export-sharding.test"));
    const spec = JSON.parse(fs.readFileSync(path.join(__dirname, "fixtures", "aws_wafv2_web_acl.test.fixture.json"), "utf-8"));
    new provider_generator_1.TerraformProviderGenerator(code, spec);
    await code.save(workdir);
    const output = fs.readFileSync(path.join(workdir, "providers/aws/wafv2/wafv2-web-acl.ts"), "utf-8");
    expect(output).toMatchSnapshot(`wafv2-web-acl-resource`);
    const outputIndex = fs.readFileSync(path.join(workdir, "providers/aws/wafv2/index.ts"), "utf-8");
    expect(outputIndex).toMatchSnapshot(`index`);
    const outputStructsIndex = fs.readFileSync(path.join(workdir, "providers/aws/wafv2/wafv2-web-acl-structs/index.ts"), "utf-8");
    expect(outputStructsIndex).toMatchSnapshot(`structs-index`);
    const outputStructs0 = fs.readFileSync(path.join(workdir, "providers/aws/wafv2/wafv2-web-acl-structs/structs0.ts"), "utf-8");
    expect(outputStructs0).toMatchSnapshot(`structs0`);
    const outputStructs400 = fs.readFileSync(path.join(workdir, "providers/aws/wafv2/wafv2-web-acl-structs/structs400.ts"), "utf-8");
    expect(outputStructs400).toMatchSnapshot(`structs400`);
    const outputStructs800 = fs.readFileSync(path.join(workdir, "providers/aws/wafv2/wafv2-web-acl-structs/structs800.ts"), "utf-8");
    expect(outputStructs800).toMatchSnapshot(`structs800`);
    const outputStructs1200 = fs.readFileSync(path.join(workdir, "providers/aws/wafv2/wafv2-web-acl-structs/structs1200.ts"), "utf-8");
    expect(outputStructs1200).toMatchSnapshot(`structs1200`);
    const outputStructs1600 = fs.readFileSync(path.join(workdir, "providers/aws/wafv2/wafv2-web-acl-structs/structs1600.ts"), "utf-8");
    expect(outputStructs1600).toMatchSnapshot(`structs1600`);
    const outputStructs2000 = fs.readFileSync(path.join(workdir, "providers/aws/wafv2/wafv2-web-acl-structs/structs2000.ts"), "utf-8");
    expect(outputStructs2000).toMatchSnapshot(`structs2000`);
    const outputStructs2400 = fs.readFileSync(path.join(workdir, "providers/aws/wafv2/wafv2-web-acl-structs/structs2400.ts"), "utf-8");
    expect(outputStructs2400).toMatchSnapshot(`structs2400`);
    const outputStructs2800 = fs.readFileSync(path.join(workdir, "providers/aws/wafv2/wafv2-web-acl-structs/structs2800.ts"), "utf-8");
    expect(outputStructs2800).toMatchSnapshot(`structs2800`);
    const outputStructs3200 = fs.readFileSync(path.join(workdir, "providers/aws/wafv2/wafv2-web-acl-structs/structs3200.ts"), "utf-8");
    expect(outputStructs3200).toMatchSnapshot(`structs3200`);
    const outputStructs3600 = fs.readFileSync(path.join(workdir, "providers/aws/wafv2/wafv2-web-acl-structs/structs3600.ts"), "utf-8");
    expect(outputStructs3600).toMatchSnapshot(`structs3600`);
});
test("shard exports across multiple files to avoid generating files with more than a 1000 exports in a provider without namespaces", async () => {
    const code = new codemaker_1.CodeMaker();
    const workdir = fs.mkdtempSync(path.join(os.tmpdir(), "export-sharding-no-namespace.test"));
    const spec = JSON.parse(fs.readFileSync(path.join(__dirname, "fixtures", "datadog_dashboard.test.fixture.json"), "utf-8"));
    new provider_generator_1.TerraformProviderGenerator(code, spec);
    await code.save(workdir);
    const output = fs.readFileSync(path.join(workdir, "providers/datadog/dashboard.ts"), "utf-8");
    expect(output).toMatchSnapshot(`dashboard-resource`);
    const outputStructsIndex = fs.readFileSync(path.join(workdir, "providers/datadog/dashboard-structs/index.ts"), "utf-8");
    expect(outputStructsIndex).toMatchSnapshot(`structs-index`);
    const outputStructs0 = fs.readFileSync(path.join(workdir, "providers/datadog/dashboard-structs/structs0.ts"), "utf-8");
    expect(outputStructs0).toMatchSnapshot(`structs0`);
    const outputStructs400 = fs.readFileSync(path.join(workdir, "providers/datadog/dashboard-structs/structs400.ts"), "utf-8");
    expect(outputStructs400).toMatchSnapshot(`structs400`);
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXhwb3J0LXNoYXJkaW5nLnRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJleHBvcnQtc2hhcmRpbmcudGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSx1Q0FBeUI7QUFDekIsdUNBQXlCO0FBQ3pCLDJDQUE2QjtBQUM3QiwyRUFBZ0Y7QUFDaEYseUNBQXNDO0FBRXRDLCtGQUErRjtBQUMvRix5R0FBeUc7QUFDekcsNEVBQTRFO0FBQzVFLElBQUksQ0FBQyw2RkFBNkYsRUFBRSxLQUFLLElBQUksRUFBRTtJQUM3RyxNQUFNLElBQUksR0FBRyxJQUFJLHFCQUFTLEVBQUUsQ0FBQztJQUM3QixNQUFNLE9BQU8sR0FBRyxFQUFFLENBQUMsV0FBVyxDQUM1QixJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxNQUFNLEVBQUUsRUFBRSxzQkFBc0IsQ0FBQyxDQUMvQyxDQUFDO0lBRUYsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FDckIsRUFBRSxDQUFDLFlBQVksQ0FDYixJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxVQUFVLEVBQUUscUNBQXFDLENBQUMsRUFDdkUsT0FBTyxDQUNSLENBQ0YsQ0FBQztJQUNGLElBQUksK0NBQTBCLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQzNDLE1BQU0sSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUV6QixNQUFNLE1BQU0sR0FBRyxFQUFFLENBQUMsWUFBWSxDQUM1QixJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxzQ0FBc0MsQ0FBQyxFQUMxRCxPQUFPLENBQ1IsQ0FBQztJQUNGLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxlQUFlLENBQUMsd0JBQXdCLENBQUMsQ0FBQztJQUV6RCxNQUFNLFdBQVcsR0FBRyxFQUFFLENBQUMsWUFBWSxDQUNqQyxJQUFJLENBQUMsSUFBSSxDQUFDLE9B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WUFBWSxDQUNwQyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxpREFBaUQsQ0FBQyxFQUNyRSxPQUFPLENBQ1IsQ0FBQztJQUNGLE1BQU0sQ0FBQyxjQUFjLENBQUMsQ0FBQyxlQUFlLENBQUMsVUFBVSxDQUFDLENBQUM7SUFFbkQsTUFBTSxnQkFBZ0IsR0FBRyxFQUFFLENBQUMsWUFBWSxDQUN0QyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxtREFBbUQsQ0FBQyxFQUN2RSxPQUFPLENBQ1IsQ0FBQztJQUNGLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLGVBQWUsQ0FBQyxZQUFZLENBQUMsQ0FBQztBQUN6RCxDQUFDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGZzIGZyb20gXCJmc1wiO1xuaW1wb3J0ICogYXMgb3MgZnJvbSBcIm9zXCI7XG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gXCJwYXRoXCI7XG5pbXBvcnQgeyBUZXJyYWZvcm1Qcm92aWRlckdlbmVyYXRvciB9IGZyb20gXCIuLi8uLi9nZW5lcmF0b3IvcHJvdmlkZXItZ2VuZXJhdG9yXCI7XG5pbXBvcnQgeyBDb2RlTWFrZXIgfSBmcm9tIFwiY29kZW1ha2VyXCI7XG5cbi8vIHRoaXMgaXMgYSB3b3JrYXJvdW5kIGZvciBhIGJ1ZyBpbnRyb2R1Y2VkIGluIFRTIDMuOS54IGFuZCBzZWVtcyB0byBiZSB1bmxpa2VseSB0byBnZXQgZml4ZWQuXG4vLyBTaW5jZSBqc2lpIHJlbGllcyBvbiBUUyA8IDQgYXQgdGhlIG1vbWVudCB3ZSBjYW4ndCB1c2UgbmV3ZXIgVFMgdmVyc2lvbnMgd2hpY2ggaGF2ZSB0aGlzIGZpeGVkICheNC4xKS5cbi8vIHNlZSBodHRwczovL2dpdGh1Yi5jb20vaGFzaGljb3JwL3RlcnJhZm9ybS1jZGsvcHVsbC8xMjQ4IGZvciBtb3JlIGNvbnRleHRcbnRlc3QoXCJzaGFyZCBleHBvcnRzIGFjcm9zcyBtdWx0aXBsZSBmaWxlcyB0byBhdm9pZCBnZW5lcmF0aW5nIGZpbGVzIHdpdGggbW9yZSB0aGFuIGEgMTAwMCBleHBvcnRzXCIsIGFzeW5jICgpID0+IHtcbiAgY29uc3QgY29kZSA9IG5ldyBDb2RlTWFrZXIoKTtcbiAgY29uc3Qgd29ya2RpciA9IGZzLm1rZHRlbXBTeW5jKFxuICAgIHBhdGguam9pbihvcy50bXBkaXIoKSwgXCJleHBvcnQtc2hhcmRpbmcudGVzdFwiKVxuICApO1xuXG4gIGNvbnN0IHNwZWMgPSBKU09OLnBhcnNlKFxuICAgIGZzLnJlYWRGaWxlU3luYyhcbiAgICAgIHBhdGguam9pbihfX2Rpcm5hbWUsIFwiZml4dHVyZXNcIiwgXCJhd3Nfd2FmdjJfd2ViX2FjbC50ZXN0LmZpeHR1cmUuanNvblwiKSxcbiAgICAgIFwidXRmLThcIlxuICAgIClcbiAgKTtcbiAgbmV3IFRlcnJhZm9ybVByb3ZpZGVyR2VuZXJhdG9yKGNvZGUsIHNwZWMpO1xuICBhd2FpdCBjb2RlLnNhdmUod29ya2Rpcik7XG5cbiAgY29uc3Qgb3V0cHV0ID0gZnMucmVhZEZpbGVTeW5jKFxuICAgIHBhdGguam9pbih3b3JrZGlyLCBcInByb3ZpZGVycy9hd3Mvd2FmdjIvd2FmdjItd2ViLWFjbC50c1wiKSxcbiAgICBcInV0Zi04XCJcbiAgKTtcbiAgZXhwZWN0KG91dHB1dCkudG9NYXRjaFNuYXBzaG90KGB3YWZ2Mi13ZWItYWNsLXJlc291cmNlYCk7XG5cbiAgY29uc3Qgb3V0cHV0SW5kZXggPSBmcy5yZWFkRmlsZVN5bmMoXG4gICAgcGF0aC5qb2luKHdvcmtkaXIsIFwicHJvdmlkZXJzL2F3cy93YWZ2Mi9pbmRleC50c1wiKSxcbiAgICBcInV0Zi04XCJcbiAgKTtcbiAgZXhwZWN0KG91dHB1dEluZGV4KS50b01hdGNoU25hcHNob3QoYGluZGV4YCk7XG5cbiAgY29uc3Qgb3V0cHV0U3RydWN0c0luZGV4ID0gZnMucmVhZEZpbGVTeW5jKFxuICAgIHBhdGguam9pbih3b3JrZGlyLCBcInByb3ZpZGVycy9hd3Mvd2FmdjIvd2FmdjItd2ViLWFjbC1zdHJ1Y3RzL2luZGV4LnRzXCIpLFxuICAgIFwidXRmLThcIlxuICApO1xuICBleHBlY3Qob3V0cHV0U3RydWN0c0luZGV4KS50b01hdGNoU25hcHNob3QoYHN0cnVjdHMtaW5kZXhgKTtcblxuICBjb25zdCBvdXRwdXRTdHJ1Y3RzMCA9IGZzLnJlYWRGaWxlU3luYyhcbiAgICBwYXRoLmpvaW4od29ya2RpciwgXCJwcm92aWRlcnMvYXdzL3dhZnYyL3dhZnYyLXdlYi1hY2wtc3RydWN0cy9zdHJ1Y3RzMC50c1wiKSxcbiAgICBcInV0Zi04XCJcbiAgKTtcbiAgZXhwZWN0KG91dHB1dFN0cnVjdHMwKS50b01hdGNoU25hcHNob3QoYHN0cnVjdHMwYCk7XG5cbiAgY29uc3Qgb3V0cHV0U3RydWN0czQwMCA9IGZzLnJlYWRGaWxlU3luYyhcbiAgICBwYXRoLmpvaW4oXG4gICAgICB3b3JrZGlyLFxuICAgICAgXCJwcm92aWRlcnMvYXdzL3dhZnYyL3dhZnYyLXdlYi1hY2wtc3RydWN0cy9zdHJ1Y3RzNDAwLnRzXCJcbiAgICApLFxuICAgIFwidXRmLThcIlxuICApO1xuICBleHBlY3Qob3V0cHV0U3RydWN0czQwMCkudG9NYXRjaFNuYXBzaG90KGBzdHJ1Y3RzNDAwYCk7XG5cbiAgY29uc3Qgb3V0cHV0U3RydWN0czgwMCA9IGZzLnJlYWRGaWxlU3luYyhcbiAgICBwYXRoLmpvaW4oXG4gICAgICB3b3JrZGlyLFxuICAgICAgXCJwcm92aWRlcnMvYXdzL3dhZnYyL3dhZnYyLXdlYi1hY2wtc3RydWN0cy9zdHJ1Y3RzODAwLnRzXCJcbiAgICApLFxuICAgIFwidXRmLThcIlxuICApO1xuICBleHBlY3Qob3V0cHV0U3RydWN0czgwMCkudG9NYXRjaFNuYXBzaG90KGBzdHJ1Y3RzODAwYCk7XG5cbiAgY29uc3Qgb3V0cHV0U3RydWN0czEyMDAgPSBmcy5yZWFkRmlsZVN5bmMoXG4gICAgcGF0aC5qb2luKFxuICAgICAgd29ya2RpcixcbiAgICAgIFwicHJvdmlkZXJzL2F3cy93YWZ2Mi93YWZ2Mi13ZWItYWNsLXN0cnVjdHMvc3RydWN0czEyMDAudHNcIlxuICAgICksXG4gICAgXCJ1dGYtOFwiXG4gICk7XG4gIGV4cGVjdChvdXRwdXRTdHJ1Y3RzMTIwMCkudG9NYXRjaFNuYXBzaG90KGBzdHJ1Y3RzMTIwMGApO1xuXG4gIGNvbnN0IG91dHB1dFN0cnVjdHMxNjAwID0gZnMucmVhZEZpbGVTeW5jKFxuICAgIHBhdGguam9pbihcbiAgICAgIHdvcmtkaXIsXG4gICAgICBcInByb3ZpZGVycy9hd3Mvd2FmdjIvd2FmdjItd2ViLWFjbC1zdHJ1Y3RzL3N0cnVjdHMxNjAwLnRzXCJcbiAgICApLFxuICAgIFwidXRmLThcIlxuICApO1xuICBleHBlY3Qob3V0cHV0U3RydWN0czE2MDApLnRvTWF0Y2hTbmFwc2hvdChgc3RydWN0czE2MDBgKTtcblxuICBjb25zdCBvdXRwdXRTdHJ1Y3RzMjAwMCA9IGZzLnJlYWRGaWxlU3luYyhcbiAgICBwYXRoLmpvaW4oXG4gICAgICB3b3JrZGlyLFxuICAgICAgXCJwcm92aWRlcnMvYXdzL3dhZnYyL3dhZnYyLXdlYi1hY2wtc3RydWN0cy9zdHJ1Y3RzMjAwMC50c1wiXG4gICAgKSxcbiAgICBcInV0Zi04XCJcbiAgKTtcbiAgZXhwZWN0KG91dHB1dFN0cnVjdHMyMDAwKS50b01hdGNoU25hcHNob3QoYHN0cnVjdHMyMDAwYCk7XG5cbiAgY29uc3Qgb3V0cHV0U3RydWN0czI0MDAgPSBmcy5yZWFkRmlsZVN5bmMoXG4gICAgcGF0aC5qb2luKFxuICAgICAgd29ya2RpcixcbiAgICAgIFwicHJvdmlkZXJzL2F3cy93YWZ2Mi93YWZ2Mi13ZWItYWNsLXN0cnVjdHMvc3RydWN0czI0MDAudHNcIlxuICAgICksXG4gICAgXCJ1dGYtOFwiXG4gICk7XG4gIGV4cGVjdChvdXRwdXRTdHJ1Y3RzMjQwMCkudG9NYXRjaFNuYXBzaG90KGBzdHJ1Y3RzMjQwMGApO1xuXG4gIGNvbnN0IG91dHB1dFN0cnVjdHMyODAwID0gZnMucmVhZEZpbGVTeW5jKFxuICAgIHBhdGguam9pbihcbiAgICAgIHdvcmtkaXIsXG4gICAgICBcInByb3ZpZGVycy9hd3Mvd2FmdjIvd2FmdjItd2ViLWFjbC1zdHJ1Y3RzL3N0cnVjdHMyODAwLnRzXCJcbiAgICApLFxuICAgIFwidXRmLThcIlxuICApO1xuICBleHBlY3Qob3V0cHV0U3RydWN0czI4MDApLnRvTWF0Y2hTbmFwc2hvdChgc3RydWN0czI4MDBgKTtcblxuICBjb25zdCBvdXRwdXRTdHJ1Y3RzMzIwMCA9IGZzLnJlYWRGaWxlU3luYyhcbiAgICBwYXRoLmpvaW4oXG4gICAgICB3b3JrZGlyLFxuICAgICAgXCJwcm92aWRlcnMvYXdzL3dhZnYyL3dhZnYyLXdlYi1hY2wtc3RydWN0cy9zdHJ1Y3RzMzIwMC50c1wiXG4gICAgKSxcbiAgICBcInV0Zi04XCJcbiAgKTtcbiAgZXhwZWN0KG91dHB1dFN0cnVjdHMzMjAwKS50b01hdGNoU25hcHNob3QoYHN0cnVjdHMzMjAwYCk7XG5cbiAgY29uc3Qgb3V0cHV0U3RydWN0czM2MDAgPSBmcy5yZWFkRmlsZVN5bmMoXG4gICAgcGF0aC5qb2luKFxuICAgICAgd29ya2RpcixcbiAgICAgIFwicHJvdmlkZXJzL2F3cy93YWZ2Mi93YWZ2Mi13ZWItYWNsLXN0cnVjdHMvc3RydWN0czM2MDAudHNcIlxuICAgICksXG4gICAgXCJ1dGYtOFwiXG4gICk7XG4gIGV4cGVjdChvdXRwdXRTdHJ1Y3RzMzYwMCkudG9NYXRjaFNuYXBzaG90KGBzdHJ1Y3RzMzYwMGApO1xufSk7XG5cbnRlc3QoXCJzaGFyZCBleHBvcnRzIGFjcm9zcyBtdWx0aXBsZSBmaWxlcyB0byBhdm9pZCBnZW5lcmF0aW5nIGZpbGVzIHdpdGggbW9yZSB0aGFuIGEgMTAwMCBleHBvcnRzIGluIGEgcHJvdmlkZXIgd2l0aG91dCBuYW1lc3BhY2VzXCIsIGFzeW5jICgpID0+IHtcbiAgY29uc3QgY29kZSA9IG5ldyBDb2RlTWFrZXIoKTtcbiAgY29uc3Qgd29ya2RpciA9IGZzLm1rZHRlbXBTeW5jKFxuICAgIHBhdGguam9pbihvcy50bXBkaXIoKSwgXCJleHBvcnQtc2hhcmRpbmctbm8tbmFtZXNwYWNlLnRlc3RcIilcbiAgKTtcblxuICBjb25zdCBzcGVjID0gSlNPTi5wYXJzZShcbiAgICBmcy5yZWFkRmlsZVN5bmMoXG4gICAgICBwYXRoLmpvaW4oX19kaXJuYW1lLCBcImZpeHR1cmVzXCIsIFwiZGF0YWRvZ19kYXNoYm9hcmQudGVzdC5maXh0dXJlLmpzb25cIiksXG4gICAgICBcInV0Zi04XCJcbiAgICApXG4gICk7XG4gIG5ldyBUZXJyYWZvcm1Qcm92aWRlckdlbmVyYXRvcihjb2RlLCBzcGVjKTtcbiAgYXdhaXQgY29kZS5zYXZlKHdvcmtkaXIpO1xuXG4gIGNvbnN0IG91dHB1dCA9IGZzLnJlYWRGaWxlU3luYyhcbiAgICBwYXRoLmpvaW4od29ya2RpciwgXCJwcm92aWRlcnMvZGF0YWRvZy9kYXNoYm9hcmQudHNcIiksXG4gICAgXCJ1dGYtOFwiXG4gICk7XG4gIGV4cGVjdChvdXRwdXQpLnRvTWF0Y2hTbmFwc2hvdChgZGFzaGJvYXJkLXJlc291cmNlYCk7XG5cbiAgY29uc3Qgb3V0cHV0U3RydWN0c0luZGV4ID0gZnMucmVhZEZpbGVTeW5jKFxuICAgIHBhdGguam9pbih3b3JrZGlyLCBcInByb3ZpZGVycy9kYXRhZG9nL2Rhc2hib2FyZC1zdHJ1Y3RzL2luZGV4LnRzXCIpLFxuICAgIFwidXRmLThcIlxuICApO1xuICBleHBlY3Qob3V0cHV0U3RydWN0c0luZGV4KS50b01hdGNoU25hcHNob3QoYHN0cnVjdHMtaW5kZXhgKTtcblxuICBjb25zdCBvdXRwdXRTdHJ1Y3RzMCA9IGZzLnJlYWRGaWxlU3luYyhcbiAgICBwYXRoLmpvaW4od29ya2RpciwgXCJwcm92aWRlcnMvZGF0YWRvZy9kYXNoYm9hcmQtc3RydWN0cy9zdHJ1Y3RzMC50c1wiKSxcbiAgICBcInV0Zi04XCJcbiAgKTtcbiAgZXhwZWN0KG91dHB1dFN0cnVjdHMwKS50b01hdGNoU25hcHNob3QoYHN0cnVjdHMwYCk7XG5cbiAgY29uc3Qgb3V0cHV0U3RydWN0czQwMCA9IGZzLnJlYWRGaWxlU3luYyhcbiAgICBwYXRoLmpvaW4od29ya2RpciwgXCJwcm92aWRlcnMvZGF0YWRvZy9kYXNoYm9hcmQtc3RydWN0cy9zdHJ1Y3RzNDAwLnRzXCIpLFxuICAgIFwidXRmLThcIlxuICApO1xuICBleHBlY3Qob3V0cHV0U3RydWN0czQwMCkudG9NYXRjaFNuYXBzaG90KGBzdHJ1Y3RzNDAwYCk7XG59KTtcbiJdfQ==