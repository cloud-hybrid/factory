"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.StructureRenderer = void 0;
const markdown_1 = require("./markdown");
/**
 * A renderer that will render a CommonMark tree to show its structure
 */
class StructureRenderer {
    block_quote(node, context) {
        return this.handle('block_quote', node, context);
    }
    code(node, context) {
        return this.handle('code', node, context);
    }
    code_block(node, context) {
        return this.handle('code_block', node, context);
    }
    text(node, context) {
        return this.handle('text', node, context);
    }
    softbreak(node, context) {
        return this.handle('softbreak', node, context);
    }
    linebreak(node, context) {
        return this.handle('linebreak', node, context);
    }
    emph(node, context) {
        return this.handle('emph', node, context);
    }
    strong(node, context) {
        return this.handle('strong', node, context);
    }
    html_inline(node, context) {
        return this.handle('html_inline', node, context);
    }
    html_block(node, context) {
        return this.handle('html_block', node, context);
    }
    link(node, context) {
        return this.handle('link', node, context);
    }
    image(node, context) {
        return this.handle('image', node, context);
    }
    document(node, context) {
        return this.handle('document', node, context);
    }
    paragraph(node, context) {
        return this.handle('paragraph', node, context);
    }
    list(node, context) {
        return this.handle('list', node, context);
    }
    item(node, context) {
        return this.handle('item', node, context);
    }
    heading(node, context) {
        return this.handle('heading', node, context);
    }
    thematic_break(node, context) {
        return this.handle('thematic_break', node, context);
    }
    custom_block(node, context) {
        return this.handle('custom_block', node, context);
    }
    custom_inline(node, context) {
        return this.handle('custom_inline', node, context);
    }
    handle(name, node, context) {
        const contents = context.content();
        const enterText = [name, inspectNode(node)].filter((x) => x).join(' ');
        if (contents) {
            return `(${enterText}\n${markdown_1.prefixLines('  ', contents)})\n`;
        }
        return `(${enterText})\n`;
    }
}
exports.StructureRenderer = StructureRenderer;
function inspectNode(n) {
    const INTERESTING_KEYS = [
        'literal',
        'destination',
        'title',
        'info',
        'level',
        'listType',
        'listTight',
        'listStart',
        'listDelimiter',
    ];
    const ret = {};
    // tslint:disable-next-line:forin
    for (const key of INTERESTING_KEYS) {
        const value = n[key];
        if (typeof value === 'string' || typeof value === 'number') {
            ret[key] = value;
        }
    }
    return JSON.stringify(ret);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RydWN0dXJlLXJlbmRlcmVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsic3RydWN0dXJlLXJlbmRlcmVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUVBLHlDQUE4RTtBQUU5RTs7R0FFRztBQUNILE1BQWEsaUJBQWlCO0lBQ3JCLFdBQVcsQ0FBQyxJQUFhLEVBQUUsT0FBd0I7UUFDeEQsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLGFBQWEsRUFBRSxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDbkQsQ0FBQztJQUNNLElBQUksQ0FBQyxJQUFhLEVBQUUsT0FBd0I7UUFDakQsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDNUMsQ0FBQztJQUNNLFVBQVUsQ0FBQyxJQUFhLEVBQUUsT0FBd0I7UUFDdkQsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLFlBQVksRUFBRSxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDbEQsQ0FBQztJQUNNLElBQUksQ0FBQyxJQUFhLEVBQUUsT0FBd0I7UUFDakQsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDNUMsQ0FBQztJQUNNLFNBQVMsQ0FBQyxJQUFhLEVBQUUsT0FBd0I7UUFDdEQsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLFdBQVcsRUFBRSxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDakQsQ0FBQztJQUNNLFNBQVMsQ0FBQyxJQUFhLEVBQUUsT0FBd0I7UUFDdEQsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLFdBQVcsRUFBRSxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDakQsQ0FBQztJQUNNLElBQUksQ0FBQyxJQUFhLEVBQUUsT0FBd0I7UUFDakQsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDNUMsQ0FBQztJQUNNLE1BQU0sQ0FBQyxJQUFhLEVBQUUsT0FBd0I7UUFDbkQsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBRSxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDOUMsQ0FBQztJQUNNLFdBQVcsQ0FBQyxJQUFhLEVBQUUsT0FBd0I7UUFDeEQsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLGFBQWEsRUFBRSxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDbkQsQ0FBQztJQUNNLFVBQVUsQ0FBQyxJQUFhLEVBQUUsT0FBd0I7UUFDdkQsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLFlBQVksRUFBRSxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDbEQsQ0FBQztJQUNNLElBQUksQ0FBQyxJQUFhLEVBQUUsT0FBd0I7UUFDakQsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDNUMsQ0FBQztJQUNNLEtBQUssQ0FBQyxJQUFhLEVBQUUsT0FBd0I7UUFDbEQsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLE9BQU8sRUFBRSxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDN0MsQ0FBQztJQUNNLFFBQVEsQ0FBQyxJQUFhLEVBQUUsT0FBd0I7UUFDckQsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLFVBQVUsRUFBRSxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDaEQsQ0FBQztJQUNNLFNBQVMsQ0FBQyxJQUFhLEVBQUUsT0FBd0I7UUFDdEQsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLFdBQVcsRUFBRSxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDakQsQ0FBQztJQUNNLElBQUksQ0FBQyxJQUFhLEVBQUUsT0FBd0I7UUFDakQsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDNUMsQ0FBQztJQUNNLElBQUksQ0FBQyxJQUFhLEVBQUUsT0FBd0I7UUFDakQsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDNUMsQ0FBQztJQUNNLE9BQU8sQ0FBQyxJQUFhLEVBQUUsT0FBd0I7UUFDcEQsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLFNBQVMsRUFBRSxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDL0MsQ0FBQztJQUNNLGNBQWMsQ0FBQyxJQUFhLEVBQUUsT0FBd0I7UUFDM0QsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLGdCQUFnQixFQUFFLElBQUksRUFBRSxPQUFPLENBQUMsQ0FBQztJQUN0RCxDQUFDO0lBQ00sWUFBWSxDQUFDLElBQWEsRUFBRSxPQUF3QjtRQUN6RCxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsY0FBYyxFQUFFLElBQUksRUFBRSxPQUFPLENBQUMsQ0FBQztJQUNwRCxDQUFDO0lBQ00sYUFBYSxDQUFDLElBQWEsRUFBRSxPQUF3QjtRQUMxRCxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsZUFBZSxFQUFFLElBQUksRUFBRSxPQUFPLENBQUMsQ0FBQztJQUNyRCxDQUFDO0lBRU8sTUFBTSxDQUFDLElBQVksRUFBRSxJQUFhLEVBQUUsT0FBd0I7UUFDbEUsTUFBTSxRQUFRLEdBQUcsT0FBTyxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBRW5DLE1BQU0sU0FBUyxHQUFHLENBQUMsSUFBSSxFQUFFLFdBQVcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBRXZFLElBQUksUUFBUSxFQUFFO1lBQ1osT0FBTyxJQUFJLFNBQVMsS0FBSyxzQkFBVyxDQUFDLElBQUksRUFBRSxRQUFRLENBQUMsS0FBSyxDQUFDO1NBQzNEO1FBQ0QsT0FBTyxJQUFJLFNBQVMsS0FBSyxDQUFDO0lBQzVCLENBQUM7Q0FDRjtBQXhFRCw4Q0F3RUM7QUFFRCxTQUFTLFdBQVcsQ0FBQyxDQUFVO0lBQzdCLE1BQU0sZ0JBQWdCLEdBQUc7UUFDdkIsU0FBUztRQUNULGFBQWE7UUFDYixPQUFPO1FBQ1AsTUFBTTtRQUNOLE9BQU87UUFDUCxVQUFVO1FBQ1YsV0FBVztRQUNYLFdBQVc7UUFDWCxlQUFlO0tBQ2hCLENBQUM7SUFDRixNQUFNLEdBQUcsR0FBUSxFQUFFLENBQUM7SUFDcEIsaUNBQWlDO0lBQ2pDLEtBQUssTUFBTSxHQUFHLElBQUksZ0JBQWdCLEVBQUU7UUFDbEMsTUFBTSxLQUFLLEdBQUksQ0FBUyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQzlCLElBQUksT0FBTyxLQUFLLEtBQUssUUFBUSxJQUFJLE9BQU8sS0FBSyxLQUFLLFFBQVEsRUFBRTtZQUMxRCxHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsS0FBSyxDQUFDO1NBQ2xCO0tBQ0Y7SUFDRCxPQUFPLElBQUksQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLENBQUM7QUFDN0IsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGNtIGZyb20gJ2NvbW1vbm1hcmsnO1xuXG5pbXBvcnQgeyBDb21tb25NYXJrUmVuZGVyZXIsIHByZWZpeExpbmVzLCBSZW5kZXJlckNvbnRleHQgfSBmcm9tICcuL21hcmtkb3duJztcblxuLyoqXG4gKiBBIHJlbmRlcmVyIHRoYXQgd2lsbCByZW5kZXIgYSBDb21tb25NYXJrIHRyZWUgdG8gc2hvdyBpdHMgc3RydWN0dXJlXG4gKi9cbmV4cG9ydCBjbGFzcyBTdHJ1Y3R1cmVSZW5kZXJlciBpbXBsZW1lbnRzIENvbW1vbk1hcmtSZW5kZXJlciB7XG4gIHB1YmxpYyBibG9ja19xdW90ZShub2RlOiBjbS5Ob2RlLCBjb250ZXh0OiBSZW5kZXJlckNvbnRleHQpIHtcbiAgICByZXR1cm4gdGhpcy5oYW5kbGUoJ2Jsb2NrX3F1b3RlJywgbm9kZSwgY29udGV4dCk7XG4gIH1cbiAgcHVibGljIGNvZGUobm9kZTogY20uTm9kZSwgY29udGV4dDogUmVuZGVyZXJDb250ZXh0KSB7XG4gICAgcmV0dXJuIHRoaXMuaGFuZGxlKCdjb2RlJywgbm9kZSwgY29udGV4dCk7XG4gIH1cbiAgcHVibGljIGNvZGVfYmxvY2sobm9kZTogY20uTm9kZSwgY29udGV4dDogUmVuZGVyZXJDb250ZXh0KSB7XG4gICAgcmV0dXJuIHRoaXMuaGFuZGxlKCdjb2RlX2Jsb2NrJywgbm9kZSwgY29udGV4dCk7XG4gIH1cbiAgcHVibGljIHRleHQobm9kZTogY20uTm9kZSwgY29udGV4dDogUmVuZGVyZXJDb250ZXh0KSB7XG4gICAgcmV0dXJuIHRoaXMuaGFuZGxlKCd0ZXh0Jywgbm9kZSwgY29udGV4dCk7XG4gIH1cbiAgcHVibGljIHNvZnRicmVhayhub2RlOiBjbS5Ob2RlLCBjb250ZXh0OiBSZW5kZXJlckNvbnRleHQpIHtcbiAgICByZXR1cm4gdGhpcy5oYW5kbGUoJ3NvZnRicmVhaycsIG5vZGUsIGNvbnRleHQpO1xuICB9XG4gIHB1YmxpYyBsaW5lYnJlYWsobm9kZTogY20uTm9kZSwgY29udGV4dDogUmVuZGVyZXJDb250ZXh0KSB7XG4gICAgcmV0dXJuIHRoaXMuaGFuZGxlKCdsaW5lYnJlYWsnLCBub2RlLCBjb250ZXh0KTtcbiAgfVxuICBwdWJsaWMgZW1waChub2RlOiBjbS5Ob2RlLCBjb250ZXh0OiBSZW5kZXJlckNvbnRleHQpIHtcbiAgICByZXR1cm4gdGhpcy5oYW5kbGUoJ2VtcGgnLCBub2RlLCBjb250ZXh0KTtcbiAgfVxuICBwdWJsaWMgc3Ryb25nKG5vZGU6IGNtLk5vZGUsIGNvbnRleHQ6IFJlbmRlcmVyQ29udGV4dCkge1xuICAgIHJldHVybiB0aGlzLmhhbmRsZSgnc3Ryb25nJywgbm9kZSwgY29udGV4dCk7XG4gIH1cbiAgcHVibGljIGh0bWxfaW5saW5lKG5vZGU6IGNtLk5vZGUsIGNvbnRleHQ6IFJlbmRlcmVyQ29udGV4dCkge1xuICAgIHJldHVybiB0aGlzLmhhbmRsZSgnaHRtbF9pbmxpbmUnLCBub2RlLCBjb250ZXh0KTtcbiAgfVxuICBwdWJsaWMgaHRtbF9ibG9jayhub2RlOiBjbS5Ob2RlLCBjb250ZXh0OiBSZW5kZXJlckNvbnRleHQpIHtcbiAgICByZXR1cm4gdGhpcy5oYW5kbGUoJ2h0bWxfYmxvY2snLCBub2RlLCBjb250ZXh0KTtcbiAgfVxuICBwdWJsaWMgbGluayhub2RlOiBjbS5Ob2RlLCBjb250ZXh0OiBSZW5kZXJlckNvbnRleHQpIHtcbiAgICByZXR1cm4gdGhpcy5oYW5kbGUoJ2xpbmsnLCBub2RlLCBjb250ZXh0KTtcbiAgfVxuICBwdWJsaWMgaW1hZ2Uobm9kZTogY20uTm9kZSwgY29udGV4dDogUmVuZGVyZXJDb250ZXh0KSB7XG4gICAgcmV0dXJuIHRoaXMuaGFuZGxlKCdpbWFnZScsIG5vZGUsIGNvbnRleHQpO1xuICB9XG4gIHB1YmxpYyBkb2N1bWVudChub2RlOiBjbS5Ob2RlLCBjb250ZXh0OiBSZW5kZXJlckNvbnRleHQpIHtcbiAgICByZXR1cm4gdGhpcy5oYW5kbGUoJ2RvY3VtZW50Jywgbm9kZSwgY29udGV4dCk7XG4gIH1cbiAgcHVibGljIHBhcmFncmFwaChub2RlOiBjbS5Ob2RlLCBjb250ZXh0OiBSZW5kZXJlckNvbnRleHQpIHtcbiAgICByZXR1cm4gdGhpcy5oYW5kbGUoJ3BhcmFncmFwaCcsIG5vZGUsIGNvbnRleHQpO1xuICB9XG4gIHB1YmxpYyBsaXN0KG5vZGU6IGNtLk5vZGUsIGNvbnRleHQ6IFJlbmRlcmVyQ29udGV4dCkge1xuICAgIHJldHVybiB0aGlzLmhhbmRsZSgnbGlzdCcsIG5vZGUsIGNvbnRleHQpO1xuICB9XG4gIHB1YmxpYyBpdGVtKG5vZGU6IGNtLk5vZGUsIGNvbnRleHQ6IFJlbmRlcmVyQ29udGV4dCkge1xuICAgIHJldHVybiB0aGlzLmhhbmRsZSgnaXRlbScsIG5vZGUsIGNvbnRleHQpO1xuICB9XG4gIHB1YmxpYyBoZWFkaW5nKG5vZGU6IGNtLk5vZGUsIGNvbnRleHQ6IFJlbmRlcmVyQ29udGV4dCkge1xuICAgIHJldHVybiB0aGlzLmhhbmRsZSgnaGVhZGluZycsIG5vZGUsIGNvbnRleHQpO1xuICB9XG4gIHB1YmxpYyB0aGVtYXRpY19icmVhayhub2RlOiBjbS5Ob2RlLCBjb250ZXh0OiBSZW5kZXJlckNvbnRleHQpIHtcbiAgICByZXR1cm4gdGhpcy5oYW5kbGUoJ3RoZW1hdGljX2JyZWFrJywgbm9kZSwgY29udGV4dCk7XG4gIH1cbiAgcHVibGljIGN1c3RvbV9ibG9jayhub2RlOiBjbS5Ob2RlLCBjb250ZXh0OiBSZW5kZXJlckNvbnRleHQpIHtcbiAgICByZXR1cm4gdGhpcy5oYW5kbGUoJ2N1c3RvbV9ibG9jaycsIG5vZGUsIGNvbnRleHQpO1xuICB9XG4gIHB1YmxpYyBjdXN0b21faW5saW5lKG5vZGU6IGNtLk5vZGUsIGNvbnRleHQ6IFJlbmRlcmVyQ29udGV4dCkge1xuICAgIHJldHVybiB0aGlzLmhhbmRsZSgnY3VzdG9tX2lubGluZScsIG5vZGUsIGNvbnRleHQpO1xuICB9XG5cbiAgcHJpdmF0ZSBoYW5kbGUobmFtZTogc3RyaW5nLCBub2RlOiBjbS5Ob2RlLCBjb250ZXh0OiBSZW5kZXJlckNvbnRleHQpIHtcbiAgICBjb25zdCBjb250ZW50cyA9IGNvbnRleHQuY29udGVudCgpO1xuXG4gICAgY29uc3QgZW50ZXJUZXh0ID0gW25hbWUsIGluc3BlY3ROb2RlKG5vZGUpXS5maWx0ZXIoKHgpID0+IHgpLmpvaW4oJyAnKTtcblxuICAgIGlmIChjb250ZW50cykge1xuICAgICAgcmV0dXJuIGAoJHtlbnRlclRleHR9XFxuJHtwcmVmaXhMaW5lcygnICAnLCBjb250ZW50cyl9KVxcbmA7XG4gICAgfVxuICAgIHJldHVybiBgKCR7ZW50ZXJUZXh0fSlcXG5gO1xuICB9XG59XG5cbmZ1bmN0aW9uIGluc3BlY3ROb2RlKG46IGNtLk5vZGUpOiBzdHJpbmcge1xuICBjb25zdCBJTlRFUkVTVElOR19LRVlTID0gW1xuICAgICdsaXRlcmFsJyxcbiAgICAnZGVzdGluYXRpb24nLFxuICAgICd0aXRsZScsXG4gICAgJ2luZm8nLFxuICAgICdsZXZlbCcsXG4gICAgJ2xpc3RUeXBlJyxcbiAgICAnbGlzdFRpZ2h0JyxcbiAgICAnbGlzdFN0YXJ0JyxcbiAgICAnbGlzdERlbGltaXRlcicsXG4gIF07XG4gIGNvbnN0IHJldDogYW55ID0ge307XG4gIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpmb3JpblxuICBmb3IgKGNvbnN0IGtleSBvZiBJTlRFUkVTVElOR19LRVlTKSB7XG4gICAgY29uc3QgdmFsdWUgPSAobiBhcyBhbnkpW2tleV07XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgfHwgdHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJykge1xuICAgICAgcmV0W2tleV0gPSB2YWx1ZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHJldCk7XG59XG4iXX0=