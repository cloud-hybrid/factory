"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.translateMarkdown = void 0;
const markdown_1 = require("../markdown/markdown");
const markdown_renderer_1 = require("../markdown/markdown-renderer");
const replace_typescript_transform_1 = require("../markdown/replace-typescript-transform");
const translate_1 = require("../translate");
function translateMarkdown(markdown, visitor, opts = {}) {
    var _a;
    const translator = new translate_1.Translator(false);
    const location = { api: 'file', fileName: markdown.fileName };
    const translatedMarkdown = markdown_1.transformMarkdown(markdown.contents, new markdown_renderer_1.MarkdownRenderer(), new replace_typescript_transform_1.ReplaceTypeScriptTransform(location, (_a = opts.strict) !== null && _a !== void 0 ? _a : false, (tsSnippet) => {
        var _a;
        const translated = translator.translatorFor(tsSnippet).renderUsing(visitor);
        return {
            language: (_a = opts.languageIdentifier) !== null && _a !== void 0 ? _a : '',
            source: translated,
        };
    }));
    return {
        translation: translatedMarkdown,
        diagnostics: translator.diagnostics,
    };
}
exports.translateMarkdown = translateMarkdown;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udmVydC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImNvbnZlcnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsbURBQXlEO0FBQ3pELHFFQUFpRTtBQUNqRSwyRkFBc0Y7QUFFdEYsNENBQTJEO0FBZTNELFNBQWdCLGlCQUFpQixDQUMvQixRQUFjLEVBQ2QsT0FBd0IsRUFDeEIsT0FBaUMsRUFBRTs7SUFFbkMsTUFBTSxVQUFVLEdBQUcsSUFBSSxzQkFBVSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBRXpDLE1BQU0sUUFBUSxHQUFHLEVBQUUsR0FBRyxFQUFFLE1BQU0sRUFBRSxRQUFRLEVBQUUsUUFBUSxDQUFDLFFBQVEsRUFBVyxDQUFDO0lBRXZFLE1BQU0sa0JBQWtCLEdBQUcsNEJBQWlCLENBQzFDLFFBQVEsQ0FBQyxRQUFRLEVBQ2pCLElBQUksb0NBQWdCLEVBQUUsRUFDdEIsSUFBSSx5REFBMEIsQ0FBQyxRQUFRLFFBQUUsSUFBSSxDQUFDLE1BQU0sbUNBQUksS0FBSyxFQUFFLENBQUMsU0FBUyxFQUFFLEVBQUU7O1FBQzNFLE1BQU0sVUFBVSxHQUFHLFVBQVUsQ0FBQyxhQUFhLENBQUMsU0FBUyxDQUFDLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQzVFLE9BQU87WUFDTCxRQUFRLFFBQUUsSUFBSSxDQUFDLGtCQUFrQixtQ0FBSSxFQUFFO1lBQ3ZDLE1BQU0sRUFBRSxVQUFVO1NBQ25CLENBQUM7SUFDSixDQUFDLENBQUMsQ0FDSCxDQUFDO0lBRUYsT0FBTztRQUNMLFdBQVcsRUFBRSxrQkFBa0I7UUFDL0IsV0FBVyxFQUFFLFVBQVUsQ0FBQyxXQUFXO0tBQ3BDLENBQUM7QUFDSixDQUFDO0FBekJELDhDQXlCQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHRyYW5zZm9ybU1hcmtkb3duIH0gZnJvbSAnLi4vbWFya2Rvd24vbWFya2Rvd24nO1xuaW1wb3J0IHsgTWFya2Rvd25SZW5kZXJlciB9IGZyb20gJy4uL21hcmtkb3duL21hcmtkb3duLXJlbmRlcmVyJztcbmltcG9ydCB7IFJlcGxhY2VUeXBlU2NyaXB0VHJhbnNmb3JtIH0gZnJvbSAnLi4vbWFya2Rvd24vcmVwbGFjZS10eXBlc2NyaXB0LXRyYW5zZm9ybSc7XG5pbXBvcnQgeyBBc3RIYW5kbGVyLCBBc3RSZW5kZXJlck9wdGlvbnMgfSBmcm9tICcuLi9yZW5kZXJlcic7XG5pbXBvcnQgeyBUcmFuc2xhdGVSZXN1bHQsIFRyYW5zbGF0b3IgfSBmcm9tICcuLi90cmFuc2xhdGUnO1xuaW1wb3J0IHsgRmlsZSB9IGZyb20gJy4uL3V0aWwnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFRyYW5zbGF0ZU1hcmtkb3duT3B0aW9ucyBleHRlbmRzIEFzdFJlbmRlcmVyT3B0aW9ucyB7XG4gIC8qKlxuICAgKiBXaGF0IGxhbmd1YWdlIHRvIHB1dCBpbiB0aGUgcmV0dXJuZWQgbWFya2Rvd24gYmxvY2tzXG4gICAqL1xuICBsYW5ndWFnZUlkZW50aWZpZXI/OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFdoZXRoZXIgdG8gb3BlcmF0ZSBpbiBgc3RyaWN0YCBtb2RlIG9yIG5vdC5cbiAgICovXG4gIHN0cmljdD86IGJvb2xlYW47XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB0cmFuc2xhdGVNYXJrZG93bihcbiAgbWFya2Rvd246IEZpbGUsXG4gIHZpc2l0b3I6IEFzdEhhbmRsZXI8YW55PixcbiAgb3B0czogVHJhbnNsYXRlTWFya2Rvd25PcHRpb25zID0ge30sXG4pOiBUcmFuc2xhdGVSZXN1bHQge1xuICBjb25zdCB0cmFuc2xhdG9yID0gbmV3IFRyYW5zbGF0b3IoZmFsc2UpO1xuXG4gIGNvbnN0IGxvY2F0aW9uID0geyBhcGk6ICdmaWxlJywgZmlsZU5hbWU6IG1hcmtkb3duLmZpbGVOYW1lIH0gYXMgY29uc3Q7XG5cbiAgY29uc3QgdHJhbnNsYXRlZE1hcmtkb3duID0gdHJhbnNmb3JtTWFya2Rvd24oXG4gICAgbWFya2Rvd24uY29udGVudHMsXG4gICAgbmV3IE1hcmtkb3duUmVuZGVyZXIoKSxcbiAgICBuZXcgUmVwbGFjZVR5cGVTY3JpcHRUcmFuc2Zvcm0obG9jYXRpb24sIG9wdHMuc3RyaWN0ID8/IGZhbHNlLCAodHNTbmlwcGV0KSA9PiB7XG4gICAgICBjb25zdCB0cmFuc2xhdGVkID0gdHJhbnNsYXRvci50cmFuc2xhdG9yRm9yKHRzU25pcHBldCkucmVuZGVyVXNpbmcodmlzaXRvcik7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBsYW5ndWFnZTogb3B0cy5sYW5ndWFnZUlkZW50aWZpZXIgPz8gJycsXG4gICAgICAgIHNvdXJjZTogdHJhbnNsYXRlZCxcbiAgICAgIH07XG4gICAgfSksXG4gICk7XG5cbiAgcmV0dXJuIHtcbiAgICB0cmFuc2xhdGlvbjogdHJhbnNsYXRlZE1hcmtkb3duLFxuICAgIGRpYWdub3N0aWNzOiB0cmFuc2xhdG9yLmRpYWdub3N0aWNzLFxuICB9O1xufVxuIl19