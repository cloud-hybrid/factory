"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Errors = void 0;
const checkpoint_1 = require("./checkpoint");
const version_check_1 = require("../bin/cmds/helper/version-check");
// Errors that will emit telemetry events
async function report(command, payload) {
    const reportParams = {
        command,
        product: "cdktf",
        version: version_check_1.versionNumber(),
        dateTime: new Date(),
        payload,
    };
    await checkpoint_1.ReportRequest(reportParams);
}
function reportPrefixedError(type) {
    return (command, message, context) => {
        report(command, { ...context, message, type });
        const err = new Error(`${type} Error: ${message}`);
        Object.entries(context || {}).forEach(([key, value]) => {
            err[key] = value;
        });
        return err;
    };
}
exports.Errors = {
    // Error within our control
    Internal: reportPrefixedError("Internal"),
    // Error in the usage
    Usage: reportPrefixedError("Usage"),
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXJyb3JzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiZXJyb3JzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLDZDQUEyRDtBQUMzRCxvRUFBaUU7QUFFakUseUNBQXlDO0FBQ3pDLEtBQUssVUFBVSxNQUFNLENBQUMsT0FBZSxFQUFFLE9BQTRCO0lBQ2pFLE1BQU0sWUFBWSxHQUFpQjtRQUNqQyxPQUFPO1FBQ1AsT0FBTyxFQUFFLE9BQU87UUFDaEIsT0FBTyxFQUFFLDZCQUFhLEVBQUU7UUFDeEIsUUFBUSxFQUFFLElBQUksSUFBSSxFQUFFO1FBQ3BCLE9BQU87S0FDUixDQUFDO0lBRUYsTUFBTSwwQkFBYSxDQUFDLFlBQVksQ0FBQyxDQUFDO0FBQ3BDLENBQUM7QUFFRCxTQUFTLG1CQUFtQixDQUFDLElBQVk7SUFDdkMsT0FBTyxDQUFDLE9BQWUsRUFBRSxPQUFlLEVBQUUsT0FBNkIsRUFBRSxFQUFFO1FBQ3pFLE1BQU0sQ0FBQyxPQUFPLEVBQUUsRUFBRSxHQUFHLE9BQU8sRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztRQUMvQyxNQUFNLEdBQUcsR0FBUSxJQUFJLEtBQUssQ0FBQyxHQUFHLElBQUksV0FBVyxPQUFPLEVBQUUsQ0FBQyxDQUFDO1FBQ3hELE1BQU0sQ0FBQyxPQUFPLENBQUMsT0FBTyxJQUFJLEVBQUUsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsR0FBRyxFQUFFLEtBQUssQ0FBQyxFQUFFLEVBQUU7WUFDckQsR0FBRyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEtBQUssQ0FBQztRQUNuQixDQUFDLENBQUMsQ0FBQztRQUNILE9BQU8sR0FBRyxDQUFDO0lBQ2IsQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQUVZLFFBQUEsTUFBTSxHQUFHO0lBQ3BCLDJCQUEyQjtJQUMzQixRQUFRLEVBQUUsbUJBQW1CLENBQUMsVUFBVSxDQUFDO0lBQ3pDLHFCQUFxQjtJQUNyQixLQUFLLEVBQUUsbUJBQW1CLENBQUMsT0FBTyxDQUFDO0NBQ3BDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSZXBvcnRQYXJhbXMsIFJlcG9ydFJlcXVlc3QgfSBmcm9tIFwiLi9jaGVja3BvaW50XCI7XG5pbXBvcnQgeyB2ZXJzaW9uTnVtYmVyIH0gZnJvbSBcIi4uL2Jpbi9jbWRzL2hlbHBlci92ZXJzaW9uLWNoZWNrXCI7XG5cbi8vIEVycm9ycyB0aGF0IHdpbGwgZW1pdCB0ZWxlbWV0cnkgZXZlbnRzXG5hc3luYyBmdW5jdGlvbiByZXBvcnQoY29tbWFuZDogc3RyaW5nLCBwYXlsb2FkOiBSZWNvcmQ8c3RyaW5nLCBhbnk+KSB7XG4gIGNvbnN0IHJlcG9ydFBhcmFtczogUmVwb3J0UGFyYW1zID0ge1xuICAgIGNvbW1hbmQsXG4gICAgcHJvZHVjdDogXCJjZGt0ZlwiLFxuICAgIHZlcnNpb246IHZlcnNpb25OdW1iZXIoKSxcbiAgICBkYXRlVGltZTogbmV3IERhdGUoKSxcbiAgICBwYXlsb2FkLFxuICB9O1xuXG4gIGF3YWl0IFJlcG9ydFJlcXVlc3QocmVwb3J0UGFyYW1zKTtcbn1cblxuZnVuY3Rpb24gcmVwb3J0UHJlZml4ZWRFcnJvcih0eXBlOiBzdHJpbmcpIHtcbiAgcmV0dXJuIChjb21tYW5kOiBzdHJpbmcsIG1lc3NhZ2U6IHN0cmluZywgY29udGV4dD86IFJlY29yZDxzdHJpbmcsIGFueT4pID0+IHtcbiAgICByZXBvcnQoY29tbWFuZCwgeyAuLi5jb250ZXh0LCBtZXNzYWdlLCB0eXBlIH0pO1xuICAgIGNvbnN0IGVycjogYW55ID0gbmV3IEVycm9yKGAke3R5cGV9IEVycm9yOiAke21lc3NhZ2V9YCk7XG4gICAgT2JqZWN0LmVudHJpZXMoY29udGV4dCB8fCB7fSkuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgICBlcnJba2V5XSA9IHZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiBlcnI7XG4gIH07XG59XG5cbmV4cG9ydCBjb25zdCBFcnJvcnMgPSB7XG4gIC8vIEVycm9yIHdpdGhpbiBvdXIgY29udHJvbFxuICBJbnRlcm5hbDogcmVwb3J0UHJlZml4ZWRFcnJvcihcIkludGVybmFsXCIpLFxuICAvLyBFcnJvciBpbiB0aGUgdXNhZ2VcbiAgVXNhZ2U6IHJlcG9ydFByZWZpeGVkRXJyb3IoXCJVc2FnZVwiKSxcbn07XG4iXX0=