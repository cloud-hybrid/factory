"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const fs = require("fs-extra");
const os = require("os");
const path = require("path");
const lib_1 = require("../lib");
test('cannot write before opening a file', () => {
    const sources = new lib_1.CodeMaker();
    expect(() => sources.line('Nope!')).toThrow(/Cannot emit source lines without opening a file/);
});
test('source files', async () => {
    const sources = new lib_1.CodeMaker();
    sources.openFile('myfile.js');
    sources.line('first line');
    sources.openBlock('open');
    sources.line('second line');
    sources.closeBlock();
    sources.open('generic open [');
    sources.line('boom');
    sources.line('bam');
    sources.close(']');
    sources.closeFile('myfile.js');
    const yourfileRelativePath = './relative/subdirs/are/also/supported/yourfile.js';
    sources.openFile(yourfileRelativePath);
    sources.line('this is your file speaking');
    // change indentation and block chars
    sources.indentation = 10;
    sources.openBlockFormatter = (s) => `(--- ${s} ---`;
    sources.closeBlockFormatter = (s) => `--- ${s} ---)`;
    sources.openBlock('block1');
    sources.line('block1.line1');
    sources.line('block1.line2');
    sources.openBlock('block2');
    sources.line('block2.line1');
    sources.closeBlock('block2 (close)');
    sources.line('block1.line3');
    sources.closeBlock('block1 (close)');
    sources.closeFile(yourfileRelativePath);
    // files can also be excluded by adding their path to exclude()
    sources.openFile('excluded.txt');
    sources.line('this file will not be emitted in save()');
    sources.closeFile('excluded.txt');
    // later in the day
    sources.exclude('excluded.txt');
    const dirname = await fs.mkdtemp(path.join(os.tmpdir(), 'source-files'));
    const files = await sources.save(dirname);
    expect(files).toHaveLength(2);
    const myfilePath = path.join(dirname, 'myfile.js');
    const yourfilePath = path.join(dirname, yourfileRelativePath);
    expect(files[0]).toBe(myfilePath);
    expect(files[1]).toBe(yourfilePath);
    const myfile = (await fs.readFile(files[0])).toString();
    const yourfile = (await fs.readFile(files[1])).toString();
    expect(myfile).toBe(expectedMyFile);
    expect(yourfile).toBe(expectedYourFile);
});
/**
 * Should fail if openFile and closeFile have are not matched.
 */
test('close file mismatch', () => {
    const sources = new lib_1.CodeMaker();
    sources.openFile('A');
    expect(() => sources.closeFile('B')).toThrow(/Cannot close file/);
});
test('custom multi-line block', async () => {
    const maker = new lib_1.CodeMaker();
    maker.openBlock = (s) => {
        maker.line(s);
        maker.open('{');
    };
    maker.openFile('custom-blocks.cpp');
    maker.openBlock('Block1()');
    maker.line('L1');
    maker.openBlock('Block2()');
    maker.line('L2');
    maker.closeBlock();
    maker.closeBlock();
    maker.closeFile('custom-blocks.cpp');
    const dirname = await fs.mkdtemp(path.join(os.tmpdir(), 'source-files'));
    const files = await maker.save(dirname);
    const actual = (await fs.readFile(files[0])).toString();
    expect(actual).toBe(expectedCustomBlocks);
});
const expectedMyFile = `first line
open {
    second line
}
generic open [
    boom
    bam
]
`;
const expectedYourFile = `this is your file speaking
(--- block1 ---
          block1.line1
          block1.line2
          (--- block2 ---
                    block2.line1
          --- block2 (close) ---)
          block1.line3
--- block1 (close) ---)
`;
const expectedCustomBlocks = `Block1()
{
    L1
    Block2()
    {
        L2
    }
}
`;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic291cmNlLnRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJzb3VyY2UudGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLCtCQUErQjtBQUMvQix5QkFBeUI7QUFDekIsNkJBQTZCO0FBRTdCLGdDQUFtQztBQUVuQyxJQUFJLENBQUMsb0NBQW9DLEVBQUUsR0FBRyxFQUFFO0lBQzlDLE1BQU0sT0FBTyxHQUFHLElBQUksZUFBUyxFQUFFLENBQUM7SUFDaEMsTUFBTSxDQUFDLEdBQUcsRUFBRSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQ3pDLGlEQUFpRCxDQUNsRCxDQUFDO0FBQ0osQ0FBQyxDQUFDLENBQUM7QUFFSCxJQUFJLENBQUMsY0FBYyxFQUFFLEtBQUssSUFBSSxFQUFFO0lBQzlCLE1BQU0sT0FBTyxHQUFHLElBQUksZUFBUyxFQUFFLENBQUM7SUFDaEMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxXQUFXLENBQUMsQ0FBQztJQUM5QixPQUFPLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDO0lBQzNCLE9BQU8sQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDMUIsT0FBTyxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQztJQUM1QixPQUFPLENBQUMsVUFBVSxFQUFFLENBQUM7SUFDckIsT0FBTyxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO0lBQy9CLE9BQU8sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDckIsT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUNwQixPQUFPLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ25CLE9BQU8sQ0FBQyxTQUFTLENBQUMsV0FBVyxDQUFDLENBQUM7SUFFL0IsTUFBTSxvQkFBb0IsR0FDeEIsbURBQW1ELENBQUM7SUFDdEQsT0FBTyxDQUFDLFFBQVEsQ0FB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QUFDLENBQUMsUUFBUSxFQUFFLENBQUM7SUFFeEQsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO0FBQzVDLENBQUMsQ0FBQyxDQUFDO0FBRUgsTUFBTSxjQUFjLEdBQUc7Ozs7Ozs7O0NBUXRCLENBQUM7QUFFRixNQUFNLGdCQUFnQixHQUFHOzs7Ozs7Ozs7Q0FTeEIsQ0FBQztBQUVGLE1BQU0sb0JBQW9CLEdBQUc7Ozs7Ozs7O0NBUTVCLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBmcyBmcm9tICdmcy1leHRyYSc7XG5pbXBvcnQgKiBhcyBvcyBmcm9tICdvcyc7XG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gJ3BhdGgnO1xuXG5pbXBvcnQgeyBDb2RlTWFrZXIgfSBmcm9tICcuLi9saWInO1xuXG50ZXN0KCdjYW5ub3Qgd3JpdGUgYmVmb3JlIG9wZW5pbmcgYSBmaWxlJywgKCkgPT4ge1xuICBjb25zdCBzb3VyY2VzID0gbmV3IENvZGVNYWtlcigpO1xuICBleHBlY3QoKCkgPT4gc291cmNlcy5saW5lKCdOb3BlIScpKS50b1Rocm93KFxuICAgIC9DYW5ub3QgZW1pdCBzb3VyY2UgbGluZXMgd2l0aG91dCBvcGVuaW5nIGEgZmlsZS8sXG4gICk7XG59KTtcblxudGVzdCgnc291cmNlIGZpbGVzJywgYXN5bmMgKCkgPT4ge1xuICBjb25zdCBzb3VyY2VzID0gbmV3IENvZGVNYWtlcigpO1xuICBzb3VyY2VzLm9wZW5GaWxlKCdteWZpbGUuanMnKTtcbiAgc291cmNlcy5saW5lKCdmaXJzdCBsaW5lJyk7XG4gIHNvdXJjZXMub3BlbkJsb2NrKCdvcGVuJyk7XG4gIHNvdXJjZXMubGluZSgnc2Vjb25kIGxpbmUnKTtcbiAgc291cmNlcy5jbG9zZUJsb2NrKCk7XG4gIHNvdXJjZXMub3BlbignZ2VuZXJpYyBvcGVuIFsnKTtcbiAgc291cmNlcy5saW5lKCdib29tJyk7XG4gIHNvdXJjZXMubGluZSgnYmFtJyk7XG4gIHNvdXJjZXMuY2xvc2UoJ10nKTtcbiAgc291cmNlcy5jbG9zZUZpbGUoJ215ZmlsZS5qcycpO1xuXG4gIGNvbnN0IHlvdXJmaWxlUmVsYXRpdmVQYXRoID1cbiAgICAnLi9yZWxhdGl2ZS9zdWJkaXJzL2FyZS9hbHNvL3N1cHBvcnRlZC95b3VyZmlsZS5qcyc7XG4gIHNvdXJjZXMub3BlbkZpbGUoeW91cmZpbGVSZWxhdGl2ZVBhdGgpO1xuICBzb3VyY2VzLmxpbmUoJ3RoaXMgaXMgeW91ciBmaWxlIHNwZWFraW5nJyk7XG5cbiAgLy8gY2hhbmdlIGluZGVudGF0aW9uIGFuZCBibG9jayBjaGFyc1xuICBzb3VyY2VzLmluZGVudGF0aW9uID0gMTA7XG4gIHNvdXJjZXMub3BlbkJsb2NrRm9ybWF0dGVyID0gKHMpID0+IGAoLS0tICR7c30gLS0tYDtcbiAgc291cmNlcy5jbG9zZUJsb2NrRm9ybWF0dGVyID0gKHMpID0+IGAtLS0gJHtzfSAtLS0pYDtcblxuICBzb3VyY2VzLm9wZW5CbG9jaygnYmxvY2sxJyk7XG4gIHNvdXJjZXMubGluZSgnYmxvY2sxLmxpbmUxJyk7XG4gIHNvdXJjZXMubGluZSgnYmxvY2sxLmxpbmUyJyk7XG4gIHNvdXJjZXMub3BlbkJsb2NrKCdibG9jazInKTtcbiAgc291cmNlcy5saW5lKCdibG9jazIubGluZTEnKTtcbiAgc291cmNlcy5jbG9zZUJsb2NrKCdibG9jazIgKGNsb3NlKScpO1xuICBzb3VyY2VzLmxpbmUoJ2Jsb2NrMS5saW5lMycpO1xuICBzb3VyY2VzLmNsb3NlQmxvY2soJ2Jsb2NrMSAoY2xvc2UpJyk7XG5cbiAgc291cmNlcy5jbG9zZUZpbGUoeW91cmZpbGVSZWxhdGl2ZVBhdGgpO1xuXG4gIC8vIGZpbGVzIGNhbiBhbHNvIGJlIGV4Y2x1ZGVkIGJ5IGFkZGluZyB0aGVpciBwYXRoIHRvIGV4Y2x1ZGUoKVxuICBzb3VyY2VzLm9wZW5GaWxlKCdleGNsdWRlZC50eHQnKTtcbiAgc291cmNlcy5saW5lKCd0aGlzIGZpbGUgd2lsbCBub3QgYmUgZW1pdHRlZCBpbiBzYXZlKCknKTtcbiAgc291cmNlcy5jbG9zZUZpbGUoJ2V4Y2x1ZGVkLnR4dCcpO1xuXG4gIC8vIGxhdGVyIGluIHRoZSBkYXlcbiAgc291cmNlcy5leGNsdWRlKCdleGNsdWRlZC50eHQnKTtcblxuICBjb25zdCBkaXJuYW1lID0gYXdhaXQgZnMubWtkdGVtcChwYXRoLmpvaW4ob3MudG1wZGlyKCksICdzb3VyY2UtZmlsZXMnKSk7XG4gIGNvbnN0IGZpbGVzID0gYXdhaXQgc291cmNlcy5zYXZlKGRpcm5hbWUpO1xuXG4gIGV4cGVjdChmaWxlcykudG9IYXZlTGVuZ3RoKDIpO1xuXG4gIGNvbnN0IG15ZmlsZVBhdGggPSBwYXRoLmpvaW4oZGlybmFtZSwgJ215ZmlsZS5qcycpO1xuICBjb25zdCB5b3VyZmlsZVBhdGggPSBwYXRoLmpvaW4oZGlybmFtZSwgeW91cmZpbGVSZWxhdGl2ZVBhdGgpO1xuXG4gIGV4cGVjdChmaWxlc1swXSkudG9CZShteWZpbGVQYXRoKTtcbiAgZXhwZWN0KGZpbGVzWzFdKS50b0JlKHlvdXJmaWxlUGF0aCk7XG5cbiAgY29uc3QgbXlmaWxlID0gKGF3YWl0IGZzLnJlYWRGaWxlKGZpbGVzWzBdKSkudG9TdHJpbmcoKTtcbiAgY29uc3QgeW91cmZpbGUgPSAoYXdhaXQgZnMucmVhZEZpbGUoZmlsZXNbMV0pKS50b1N0cmluZygpO1xuXG4gIGV4cGVjdChteWZpbGUpLnRvQmUoZXhwZWN0ZWRNeUZpbGUpO1xuICBleHBlY3QoeW91cmZpbGUpLnRvQmUoZXhwZWN0ZWRZb3VyRmlsZSk7XG59KTtcblxuLyoqXG4gKiBTaG91bGQgZmFpbCBpZiBvcGVuRmlsZSBhbmQgY2xvc2VGaWxlIGhhdmUgYXJlIG5vdCBtYXRjaGVkLlxuICovXG50ZXN0KCdjbG9zZSBmaWxlIG1pc21hdGNoJywgKCkgPT4ge1xuICBjb25zdCBzb3VyY2VzID0gbmV3IENvZGVNYWtlcigpO1xuICBzb3VyY2VzLm9wZW5GaWxlKCdBJyk7XG4gIGV4cGVjdCgoKSA9PiBzb3VyY2VzLmNsb3NlRmlsZSgnQicpKS50b1Rocm93KC9DYW5ub3QgY2xvc2UgZmlsZS8pO1xufSk7XG5cbnRlc3QoJ2N1c3RvbSBtdWx0aS1saW5lIGJsb2NrJywgYXN5bmMgKCkgPT4ge1xuICBjb25zdCBtYWtlciA9IG5ldyBDb2RlTWFrZXIoKTtcblxuICBtYWtlci5vcGVuQmxvY2sgPSAocykgPT4ge1xuICAgIG1ha2VyLmxpbmUocyk7XG4gICAgbWFrZXIub3BlbigneycpO1xuICB9O1xuXG4gIG1ha2VyLm9wZW5GaWxlKCdjdXN0b20tYmxvY2tzLmNwcCcpO1xuICBtYWtlci5vcGVuQmxvY2soJ0Jsb2NrMSgpJyk7XG4gIG1ha2VyLmxpbmUoJ0wxJyk7XG4gIG1ha2VyLm9wZW5CbG9jaygnQmxvY2syKCknKTtcbiAgbWFrZXIubGluZSgnTDInKTtcbiAgbWFrZXIuY2xvc2VCbG9jaygpO1xuICBtYWtlci5jbG9zZUJsb2NrKCk7XG4gIG1ha2VyLmNsb3NlRmlsZSgnY3VzdG9tLWJsb2Nrcy5jcHAnKTtcblxuICBjb25zdCBkaXJuYW1lID0gYXdhaXQgZnMubWtkdGVtcChwYXRoLmpvaW4ob3MudG1wZGlyKCksICdzb3VyY2UtZmlsZXMnKSk7XG4gIGNvbnN0IGZpbGVzID0gYXdhaXQgbWFrZXIuc2F2ZShkaXJuYW1lKTtcblxuICBjb25zdCBhY3R1YWwgPSAoYXdhaXQgZnMucmVhZEZpbGUoZmlsZXNbMF0pKS50b1N0cmluZygpO1xuXG4gIGV4cGVjdChhY3R1YWwpLnRvQmUoZXhwZWN0ZWRDdXN0b21CbG9ja3MpO1xufSk7XG5cbmNvbnN0IGV4cGVjdGVkTXlGaWxlID0gYGZpcnN0IGxpbmVcbm9wZW4ge1xuICAgIHNlY29uZCBsaW5lXG59XG5nZW5lcmljIG9wZW4gW1xuICAgIGJvb21cbiAgICBiYW1cbl1cbmA7XG5cbmNvbnN0IGV4cGVjdGVkWW91ckZpbGUgPSBgdGhpcyBpcyB5b3VyIGZpbGUgc3BlYWtpbmdcbigtLS0gYmxvY2sxIC0tLVxuICAgICAgICAgIGJsb2NrMS5saW5lMVxuICAgICAgICAgIGJsb2NrMS5saW5lMlxuICAgICAgICAgICgtLS0gYmxvY2syIC0tLVxuICAgICAgICAgICAgICAgICAgICBibG9jazIubGluZTFcbiAgICAgICAgICAtLS0gYmxvY2syIChjbG9zZSkgLS0tKVxuICAgICAgICAgIGJsb2NrMS5saW5lM1xuLS0tIGJsb2NrMSAoY2xvc2UpIC0tLSlcbmA7XG5cbmNvbnN0IGV4cGVjdGVkQ3VzdG9tQmxvY2tzID0gYEJsb2NrMSgpXG57XG4gICAgTDFcbiAgICBCbG9jazIoKVxuICAgIHtcbiAgICAgICAgTDJcbiAgICB9XG59XG5gO1xuIl19