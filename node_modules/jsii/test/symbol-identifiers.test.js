"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const lib_1 = require("../lib");
test('Symbol map is generated', async () => {
    var _a;
    const result = await lib_1.compileJsiiForTest({
        'index.ts': `
        export * from './some/nested/file';
        export class Foo {
          public bar(){}
        }
      `,
        'some/nested/file.ts': `
        export interface Bar {
          readonly x: string;
        }
        export enum Baz {
          ALPHA = 0,
          BETA = 1,
        }
        `,
    }, undefined /* callback */, { stripDeprecated: true });
    const types = (_a = result.assembly.types) !== null && _a !== void 0 ? _a : {};
    expect(types['testpkg.Foo'].symbolId).toEqual('index:Foo');
    expect(types['testpkg.Bar'].symbolId).toEqual('some/nested/file:Bar');
    expect(types['testpkg.Baz'].symbolId).toEqual('some/nested/file:Baz');
});
test('Symbol id for single-value enum correctly identifies enum', async () => {
    var _a;
    const result = await lib_1.compileJsiiForTest({
        'index.ts': `
        export enum SomeEnum {
          SINGLETON_VALUE = 'value',
        }
      `,
    }, undefined /* callback */, { stripDeprecated: true });
    const types = (_a = result.assembly.types) !== null && _a !== void 0 ? _a : {};
    expect(types['testpkg.SomeEnum'].symbolId).toEqual('index:SomeEnum');
});
test('Module declarations are included in symbolId', async () => {
    var _a;
    const result = await lib_1.compileJsiiForTest({
        'index.ts': `
        export class Foo {
          constructor() {
          }
        }
        export namespace Foo {
          export class Bar {
            public baz() {}
          }
        }
      `,
    }, undefined /* callback */, { stripDeprecated: true });
    const types = (_a = result.assembly.types) !== null && _a !== void 0 ? _a : {};
    expect(types['testpkg.Foo.Bar'].symbolId).toEqual('index:Foo.Bar');
});
test('Submodules also have symbol identifiers', async () => {
    var _a, _b;
    const result = await lib_1.compileJsiiForTest({
        'index.ts': `export * as submod from './submodule';`,
        'submodule.ts': `
        export class Foo {
          constructor() {
          }
        }
      `,
    }, undefined /* callback */, { stripDeprecated: true });
    expect((_b = (_a = result.assembly.submodules) === null || _a === void 0 ? void 0 : _a['testpkg.submod']) === null || _b === void 0 ? void 0 : _b.symbolId).toEqual('submodule:');
});
test('Submodules also have symbol identifiers', async () => {
    var _a, _b;
    const result = await lib_1.compileJsiiForTest({
        'index.ts': `
        export namespace cookie {
          export class Foo {
            constructor() {
            }
          }
        }
      `,
    }, undefined /* callback */, { stripDeprecated: true });
    expect((_b = (_a = result.assembly.submodules) === null || _a === void 0 ? void 0 : _a['testpkg.cookie']) === null || _b === void 0 ? void 0 : _b.symbolId).toEqual('index:cookie');
});
describe(lib_1.normalizePath, () => {
    test('basic rootDir and outDir', () => {
        expect(lib_1.normalizePath('out/filename.ts', 'root', 'out')).toEqual('root/filename.ts');
        expect(lib_1.normalizePath('out/filename.ts', undefined, 'out')).toEqual('out/filename.ts');
        expect(lib_1.normalizePath('out/filename.ts', 'root', undefined)).toEqual('out/filename.ts');
        expect(lib_1.normalizePath('out/filename.ts', undefined, undefined)).toEqual('out/filename.ts');
    });
    test('extra slashes in directories', () => {
        expect(lib_1.normalizePath('out/filename.ts', 'root/', 'out/')).toEqual('root/filename.ts');
        expect(lib_1.normalizePath('out/filename.ts', 'root////', 'out////')).toEqual('root/filename.ts');
        // eslint-disable-next-line prettier/prettier
        expect(lib_1.normalizePath('out/lib/filename.ts', 'root///', 'out//lib//')).toEqual('root/filename.ts');
    });
    test('additional paths in directories', () => {
        expect(lib_1.normalizePath('out/filename.ts', './root', 'out')).toEqual('root/filename.ts');
        expect(lib_1.normalizePath('out/filename.ts', 'root', './out')).toEqual('root/filename.ts');
        expect(lib_1.normalizePath('out/filename.ts', 'root', './here/../out')).toEqual('root/filename.ts');
        expect(lib_1.normalizePath('out/filename.ts', 'root/../root/..', '.')).toEqual('out/filename.ts');
    });
    test('empty paths', () => {
        expect(lib_1.normalizePath('out/lib/filename.ts', '', 'out')).toEqual('lib/filename.ts');
        expect(lib_1.normalizePath('out/lib/filename.ts', '.', 'out')).toEqual('lib/filename.ts');
        expect(lib_1.normalizePath('lib/filename.ts', 'root', '')).toEqual('root/lib/filename.ts');
        expect(lib_1.normalizePath('lib/filename.ts', 'root', '.')).toEqual('root/lib/filename.ts');
        // eslint-disable-next-line prettier/prettier
        expect(lib_1.normalizePath('lib/filename.ts', '', '')).toEqual('lib/filename.ts');
        expect(lib_1.normalizePath('lib/filename.ts', '.', '.')).toEqual('lib/filename.ts');
    });
    test('specify multiple directories', () => {
        expect(lib_1.normalizePath('out/lib/filename.ts', 'root', 'out/lib')).toEqual('root/filename.ts');
        expect(lib_1.normalizePath('out/lib/filename.ts', 'root/extra', 'out')).toEqual('root/extra/lib/filename.ts');
        expect(lib_1.normalizePath('out/lib/filename.ts', '.', 'out/lib')).toEqual('filename.ts');
        expect(lib_1.normalizePath('lib/filename.ts', 'root/extra', '.')).toEqual('root/extra/lib/filename.ts');
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3ltYm9sLWlkZW50aWZpZXJzLnRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJzeW1ib2wtaWRlbnRpZmllcnMudGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLGdDQUEyRDtBQUUzRCxJQUFJLENBQUMseUJBQXlCLEVBQUUsS0FBSyxJQUFJLEVBQUU7O0lBQ3pDLE1BQU0sTUFBTSxHQUFHLE1BQU0sd0JBQWtCLENBQ3JDO1FBQ0UsVUFBVSxFQUFFOzs7OztPQUtYO1FBQ0QscUJBQXFCLEVBQUU7Ozs7Ozs7O1NBUXBCO0tBQ0osRUFDRCxTQUFTLENBQUMsY0FBYyxFQUN4QixFQUFFLGVBQWUsRUFBRSxJQUFJLEVBQUUsQ0FDMUIsQ0FBQztJQUVGLE1BQU0sS0FBSyxTQUFHLE1BQU0sQ0FBQyxRQUFRLENBQUMsS0FBSyxtQ0FBSSxFQUFFLENBQUM7SUFDMUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxhQUFhLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUM7SUFDM0QsTUFBTSxDQUFDLEtBQUssQ0FBQyxhQUFhLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxPQUFPLENBQUMsc0JBQXNCLENBQUMsQ0FBQztJQUN0RSxNQUFNLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDO0FBQ3hFLENBQUMsQ0FBQyxDQUFDO0FBRUgsSUFBSSxDQUFDLDJEQUEyRCxFQUFFLEtBQUssSUFBSSxFQUFFOztJQUMzRSxNQUFNLE1BQU0sR0FBRyxNQUFNLHdCQUFrQixDQUNyQztRQUNFLFVBQVUsRUFBRTs7OztPQUlYO0tBQ0YsRUFDRCxTQUFTLENBQUMsY0FBYyxFQUN4QixFQUFFLGVBQWUsRUFBRSxJQUFJLEVBQUUsQ0FDMUIsQ0FBQztJQUVGLE1BQU0sS0FBSyxTQUFHLE1BQU0sQ0FBQyxRQUFRLENBQUMsS0FBSyxtQ0FBSSxF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QUFDLG1CQUFhLENBQUMsaUJBQWlCLEVBQUUsTUFBTSxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUMzRCxzQkFBc0IsQ0FDdkIsQ0FBQztRQUNGLDZDQUE2QztRQUM3QyxNQUFNLENBQUMsbUJBQWEsQ0FBQyxpQkFBaUIsRUFBRSxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQ3RELGlCQUFpQixDQUNsQixDQUFDO1FBQ0YsTUFBTSxDQUFDLG1CQUFhLENBQUMsaUJBQWlCLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUN4RCxpQkFBaUIsQ0FDbEIsQ0FBQztJQUNKLENBQUMsQ0FBQyxDQUFDO0lBRUgsSUFBSSxDQUFDLDhCQUE4QixFQUFFLEdBQUcsRUFBRTtRQUN4QyxNQUFNLENBQUMsbUJBQWEsQ0FBQyxxQkFBcUIsRUFBRSxNQUFNLEVBQUUsU0FBUyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQ3JFLGtCQUFrQixDQUNuQixDQUFDO1FBQ0YsTUFBTSxDQUFDLG1CQUFhLENBQUMscUJBQXFCLEVBQUUsWUFBWSxFQUFFLEtBQUssQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUN2RSw0QkFBNEIsQ0FDN0IsQ0FBQztRQUNGLE1BQU0sQ0FBQyxtQkFBYSxDQUFDLHFCQUFxQixFQUFFLEdBQUcsRUFBRSxTQUFTLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FDbEUsYUFBYSxDQUNkLENBQUM7UUFDRixNQUFNLENBQUMsbUJBQWEsQ0FBQyxpQkFBaUIsRUFBRSxZQUFZLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQ2pFLDRCQUE0QixDQUM3QixDQUFDO0lBQ0osQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNvbXBpbGVKc2lpRm9yVGVzdCwgbm9ybWFsaXplUGF0aCB9IGZyb20gJy4uL2xpYic7XG5cbnRlc3QoJ1N5bWJvbCBtYXAgaXMgZ2VuZXJhdGVkJywgYXN5bmMgKCkgPT4ge1xuICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb21waWxlSnNpaUZvclRlc3QoXG4gICAge1xuICAgICAgJ2luZGV4LnRzJzogYFxuICAgICAgICBleHBvcnQgKiBmcm9tICcuL3NvbWUvbmVzdGVkL2ZpbGUnO1xuICAgICAgICBleHBvcnQgY2xhc3MgRm9vIHtcbiAgICAgICAgICBwdWJsaWMgYmFyKCl7fVxuICAgICAgICB9XG4gICAgICBgLFxuICAgICAgJ3NvbWUvbmVzdGVkL2ZpbGUudHMnOiBgXG4gICAgICAgIGV4cG9ydCBpbnRlcmZhY2UgQmFyIHtcbiAgICAgICAgICByZWFkb25seSB4OiBzdHJpbmc7XG4gICAgICAgIH1cbiAgICAgICAgZXhwb3J0IGVudW0gQmF6IHtcbiAgICAgICAgICBBTFBIQSA9IDAsXG4gICAgICAgICAgQkVUQSA9IDEsXG4gICAgICAgIH1cbiAgICAgICAgYCxcbiAgICB9LFxuICAgIHVuZGVmaW5lZCAvKiBjYWxsYmFjayAqLyxcbiAgICB7IHN0cmlwRGVwcmVjYXRlZDogdHJ1ZSB9LFxuICApO1xuXG4gIGNvbnN0IHR5cGVzID0gcmVzdWx0LmFzc2VtYmx5LnR5cGVzID8/IHt9O1xuICBleHBlY3QodHlwZXNbJ3Rlc3Rwa2cuRm9vJ10uc3ltYm9sSWQpLnRvRXF1YWwoJ2luZGV4OkZvbycpO1xuICBleHBlY3QodHlwZXNbJ3Rlc3Rwa2cuQmFyJ10uc3ltYm9sSWQpLnRvRXF1YWwoJ3NvbWUvbmVzdGVkL2ZpbGU6QmFyJyk7XG4gIGV4cGVjdCh0eXBlc1sndGVzdHBrZy5CYXonXS5zeW1ib2xJZCkudG9FcXVhbCgnc29tZS9uZXN0ZWQvZmlsZTpCYXonKTtcbn0pO1xuXG50ZXN0KCdTeW1ib2wgaWQgZm9yIHNpbmdsZS12YWx1ZSBlbnVtIGNvcnJlY3RseSBpZGVudGlmaWVzIGVudW0nLCBhc3luYyAoKSA9PiB7XG4gIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbXBpbGVKc2lpRm9yVGVzdChcbiAgICB7XG4gICAgICAnaW5kZXgudHMnOiBgXG4gICAgICAgIGV4cG9ydCBlbnVtIFNvbWVFbnVtIHtcbiAgICAgICAgICBTSU5HTEVUT05fVkFMVUUgPSAndmFsdWUnLFxuICAgICAgICB9XG4gICAgICBgLFxuICAgIH0sXG4gICAgdW5kZWZpbmVkIC8qIGNhbGxiYWNrICovLFxuICAgIHsgc3RyaXBEZXByZWNhdGVkOiB0cnVlIH0sXG4gICk7XG5cbiAgY29uc3QgdHlwZXMgPSByZXN1bHQuYXNzZW1ibHkudHlwZXMgPz8ge307XG4gIGV4cGVjdCh0eXBlc1sndGVzdHBrZy5Tb21lRW51bSddLnN5bWJvbElkKS50b0VxdWFsKCdpbmRleDpTb21lRW51bScpO1xufSk7XG5cbnRlc3QoJ01vZHVsZSBkZWNsYXJhdGlvbnMgYXJlIGluY2x1ZGVkIGluIHN5bWJvbElkJywgYXN5bmMgKCkgPT4ge1xuICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb21waWxlSnNpaUZvclRlc3QoXG4gICAge1xuICAgICAgJ2luZGV4LnRzJzogYFxuICAgICAgICBleHBvcnQgY2xhc3MgRm9vIHtcbiAgICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZXhwb3J0IG5hbWVzcGFjZSBGb28ge1xuICAgICAgICAgIGV4cG9ydCBjbGFzcyBCYXIge1xuICAgICAgICAgICAgcHVibGljIGJheigpIHt9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICBgLFxuICAgIH0sXG4gICAgdW5kZWZpbmVkIC8qIGNhbGxiYWNrICovLFxuICAgIHsgc3RyaXBEZXByZWNhdGVkOiB0cnVlIH0sXG4gICk7XG5cbiAgY29uc3QgdHlwZXMgPSByZXN1bHQuYXNzZW1ibHkudHlwZXMgPz8ge307XG4gIGV4cGVjdCh0eXBlc1sndGVzdHBrZy5Gb28uQmFyJ10uc3ltYm9sSWQpLnRvRXF1YWwoJ2luZGV4OkZvby5CYXInKTtcbn0pO1xuXG50ZXN0KCdTdWJtb2R1bGVzIGFsc28gaGF2ZSBzeW1ib2wgaWRlbnRpZmllcnMnLCBhc3luYyAoKSA9PiB7XG4gIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbXBpbGVKc2lpRm9yVGVzdChcbiAgICB7XG4gICAgICAnaW5kZXgudHMnOiBgZXhwb3J0ICogYXMgc3VibW9kIGZyb20gJy4vc3VibW9kdWxlJztgLFxuICAgICAgJ3N1Ym1vZHVsZS50cyc6IGBcbiAgICAgICAgZXhwb3J0IGNsYXNzIEZvbyB7XG4gICAgICAgICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICBgLFxuICAgIH0sXG4gICAgdW5kZWZpbmVkIC8qIGNhbGxiYWNrICovLFxuICAgIHsgc3RyaXBEZXByZWNhdGVkOiB0cnVlIH0sXG4gICk7XG5cbiAgZXhwZWN0KHJlc3VsdC5hc3NlbWJseS5zdWJtb2R1bGVzPy5bJ3Rlc3Rwa2cuc3VibW9kJ10/LnN5bWJvbElkKS50b0VxdWFsKFxuICAgICdzdWJtb2R1bGU6JyxcbiAgKTtcbn0pO1xuXG50ZXN0KCdTdWJtb2R1bGVzIGFsc28gaGF2ZSBzeW1ib2wgaWRlbnRpZmllcnMnLCBhc3luYyAoKSA9PiB7XG4gIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbXBpbGVKc2lpRm9yVGVzdChcbiAgICB7XG4gICAgICAnaW5kZXgudHMnOiBgXG4gICAgICAgIGV4cG9ydCBuYW1lc3BhY2UgY29va2llIHtcbiAgICAgICAgICBleHBvcnQgY2xhc3MgRm9vIHtcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgYCxcbiAgICB9LFxuICAgIHVuZGVmaW5lZCAvKiBjYWxsYmFjayAqLyxcbiAgICB7IHN0cmlwRGVwcmVjYXRlZDogdHJ1ZSB9LFxuICApO1xuXG4gIGV4cGVjdChyZXN1bHQuYXNzZW1ibHkuc3VibW9kdWxlcz8uWyd0ZXN0cGtnLmNvb2tpZSddPy5zeW1ib2xJZCkudG9FcXVhbChcbiAgICAnaW5kZXg6Y29va2llJyxcbiAgKTtcbn0pO1xuXG5kZXNjcmliZShub3JtYWxpemVQYXRoLCAoKSA9PiB7XG4gIHRlc3QoJ2Jhc2ljIHJvb3REaXIgYW5kIG91dERpcicsICgpID0+IHtcbiAgICBleHBlY3Qobm9ybWFsaXplUGF0aCgnb3V0L2ZpbGVuYW1lLnRzJywgJ3Jvb3QnLCAnb3V0JykpLnRvRXF1YWwoXG4gICAgICAncm9vdC9maWxlbmFtZS50cycsXG4gICAgKTtcbiAgICBleHBlY3Qobm9ybWFsaXplUGF0aCgnb3V0L2ZpbGVuYW1lLnRzJywgdW5kZWZpbmVkLCAnb3V0JykpLnRvRXF1YWwoXG4gICAgICAnb3V0L2ZpbGVuYW1lLnRzJyxcbiAgICApO1xuICAgIGV4cGVjdChub3JtYWxpemVQYXRoKCdvdXQvZmlsZW5hbWUudHMnLCAncm9vdCcsIHVuZGVmaW5lZCkpLnRvRXF1YWwoXG4gICAgICAnb3V0L2ZpbGVuYW1lLnRzJyxcbiAgICApO1xuICAgIGV4cGVjdChub3JtYWxpemVQYXRoKCdvdXQvZmlsZW5hbWUudHMnLCB1bmRlZmluZWQsIHVuZGVmaW5lZCkpLnRvRXF1YWwoXG4gICAgICAnb3V0L2ZpbGVuYW1lLnRzJyxcbiAgICApO1xuICB9KTtcblxuICB0ZXN0KCdleHRyYSBzbGFzaGVzIGluIGRpcmVjdG9yaWVzJywgKCkgPT4ge1xuICAgIGV4cGVjdChub3JtYWxpemVQYXRoKCdvdXQvZmlsZW5hbWUudHMnLCAncm9vdC8nLCAnb3V0LycpKS50b0VxdWFsKFxuICAgICAgJ3Jvb3QvZmlsZW5hbWUudHMnLFxuICAgICk7XG4gICAgZXhwZWN0KG5vcm1hbGl6ZVBhdGgoJ291dC9maWxlbmFtZS50cycsICdyb290Ly8vLycsICdvdXQvLy8vJykpLnRvRXF1YWwoXG4gICAgICAncm9vdC9maWxlbmFtZS50cycsXG4gICAgKTtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcHJldHRpZXIvcHJldHRpZXJcbiAgICBleHBlY3Qobm9ybWFsaXplUGF0aCgnb3V0L2xpYi9maWxlbmFtZS50cycsICdyb290Ly8vJywgJ291dC8vbGliLy8nKSkudG9FcXVhbChcbiAgICAgICdyb290L2ZpbGVuYW1lLnRzJyxcbiAgICApO1xuICB9KTtcblxuICB0ZXN0KCdhZGRpdGlvbmFsIHBhdGhzIGluIGRpcmVjdG9yaWVzJywgKCkgPT4ge1xuICAgIGV4cGVjdChub3JtYWxpemVQYXRoKCdvdXQvZmlsZW5hbWUudHMnLCAnLi9yb290JywgJ291dCcpKS50b0VxdWFsKFxuICAgICAgJ3Jvb3QvZmlsZW5hbWUudHMnLFxuICAgICk7XG4gICAgZXhwZWN0KG5vcm1hbGl6ZVBhdGgoJ291dC9maWxlbmFtZS50cycsICdyb290JywgJy4vb3V0JykpLnRvRXF1YWwoXG4gICAgICAncm9vdC9maWxlbmFtZS50cycsXG4gICAgKTtcbiAgICBleHBlY3Qobm9ybWFsaXplUGF0aCgnb3V0L2ZpbGVuYW1lLnRzJywgJ3Jvb3QnLCAnLi9oZXJlLy4uL291dCcpKS50b0VxdWFsKFxuICAgICAgJ3Jvb3QvZmlsZW5hbWUudHMnLFxuICAgICk7XG4gICAgZXhwZWN0KG5vcm1hbGl6ZVBhdGgoJ291dC9maWxlbmFtZS50cycsICdyb290Ly4uL3Jvb3QvLi4nLCAnLicpKS50b0VxdWFsKFxuICAgICAgJ291dC9maWxlbmFtZS50cycsXG4gICAgKTtcbiAgfSk7XG5cbiAgdGVzdCgnZW1wdHkgcGF0aHMnLCAoKSA9PiB7XG4gICAgZXhwZWN0KG5vcm1hbGl6ZVBhdGgoJ291dC9saWIvZmlsZW5hbWUudHMnLCAnJywgJ291dCcpKS50b0VxdWFsKFxuICAgICAgJ2xpYi9maWxlbmFtZS50cycsXG4gICAgKTtcbiAgICBleHBlY3Qobm9ybWFsaXplUGF0aCgnb3V0L2xpYi9maWxlbmFtZS50cycsICcuJywgJ291dCcpKS50b0VxdWFsKFxuICAgICAgJ2xpYi9maWxlbmFtZS50cycsXG4gICAgKTtcbiAgICBleHBlY3Qobm9ybWFsaXplUGF0aCgnbGliL2ZpbGVuYW1lLnRzJywgJ3Jvb3QnLCAnJykpLnRvRXF1YWwoXG4gICAgICAncm9vdC9saWIvZmlsZW5hbWUudHMnLFxuICAgICk7XG4gICAgZXhwZWN0KG5vcm1hbGl6ZVBhdGgoJ2xpYi9maWxlbmFtZS50cycsICdyb290JywgJy4nKSkudG9FcXVhbChcbiAgICAgICdyb290L2xpYi9maWxlbmFtZS50cycsXG4gICAgKTtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcHJldHRpZXIvcHJldHRpZXJcbiAgICBleHBlY3Qobm9ybWFsaXplUGF0aCgnbGliL2ZpbGVuYW1lLnRzJywgJycsICcnKSkudG9FcXVhbChcbiAgICAgICdsaWIvZmlsZW5hbWUudHMnLFxuICAgICk7XG4gICAgZXhwZWN0KG5vcm1hbGl6ZVBhdGgoJ2xpYi9maWxlbmFtZS50cycsICcuJywgJy4nKSkudG9FcXVhbChcbiAgICAgICdsaWIvZmlsZW5hbWUudHMnLFxuICAgICk7XG4gIH0pO1xuXG4gIHRlc3QoJ3NwZWNpZnkgbXVsdGlwbGUgZGlyZWN0b3JpZXMnLCAoKSA9PiB7XG4gICAgZXhwZWN0KG5vcm1hbGl6ZVBhdGgoJ291dC9saWIvZmlsZW5hbWUudHMnLCAncm9vdCcsICdvdXQvbGliJykpLnRvRXF1YWwoXG4gICAgICAncm9vdC9maWxlbmFtZS50cycsXG4gICAgKTtcbiAgICBleHBlY3Qobm9ybWFsaXplUGF0aCgnb3V0L2xpYi9maWxlbmFtZS50cycsICdyb290L2V4dHJhJywgJ291dCcpKS50b0VxdWFsKFxuICAgICAgJ3Jvb3QvZXh0cmEvbGliL2ZpbGVuYW1lLnRzJyxcbiAgICApO1xuICAgIGV4cGVjdChub3JtYWxpemVQYXRoKCdvdXQvbGliL2ZpbGVuYW1lLnRzJywgJy4nLCAnb3V0L2xpYicpKS50b0VxdWFsKFxuICAgICAgJ2ZpbGVuYW1lLnRzJyxcbiAgICApO1xuICAgIGV4cGVjdChub3JtYWxpemVQYXRoKCdsaWIvZmlsZW5hbWUudHMnLCAncm9vdC9leHRyYScsICcuJykpLnRvRXF1YWwoXG4gICAgICAncm9vdC9leHRyYS9saWIvZmlsZW5hbWUudHMnLFxuICAgICk7XG4gIH0pO1xufSk7XG4iXX0=