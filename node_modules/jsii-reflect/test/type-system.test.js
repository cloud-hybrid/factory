"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const spec = require("@jsii/spec");
const spec_1 = require("@jsii/spec");
const path = require("path");
const lib_1 = require("../lib");
const util_1 = require("./util");
let typesys;
beforeAll(async () => {
    typesys = new lib_1.TypeSystem();
    await typesys.loadModule(resolveModuleDir('jsii-calc'));
});
test('TypeSystem.hasAssembly', () => {
    expect(typesys.includesAssembly('@foo/bar')).toBeFalsy();
    expect(typesys.includesAssembly('jsii-calc')).toBeTruthy();
    expect(typesys.includesAssembly('@scope/jsii-calc-lib')).toBeTruthy();
});
test('TypeSystem.assemblies lists all the loaded assemblies', () => expect(typesys.assemblies.map((a) => a.name).sort()).toMatchSnapshot());
test('TypeSystem.classes lists all the classes in the typesystem', () => expect(typesys.classes.map((c) => c.fqn).sort()).toMatchSnapshot());
test('findClass', () => {
    const calc = typesys.findClass('jsii-calc.Calculator');
    const actual = new Array();
    Object.values(calc.getMethods(/* inherited */ true)).forEach((method) => {
        actual.push(`${method.name} from ${method.parentType.name}`);
    });
    expect(actual.join('\n')).toMatchSnapshot();
});
test('"roots" is a list of the directly loaded assemblies', async () => {
    expect(typesys.roots.length).toBe(1);
    expect(typesys.roots[0]).toBe(typesys.findAssembly('jsii-calc'));
    // now load another assembliy directly
    await typesys.load(resolveModuleDir('@scope/jsii-calc-lib'));
    return expect(typesys.roots.length).toBe(2);
});
describe('Type', () => {
    test('.isClassType', () => {
        // GIVEN
        const clazz = typesys.findFqn('jsii-calc.AllTypes');
        const iface = typesys.findFqn('jsii-calc.IPublicInterface');
        const enumt = typesys.findFqn('jsii-calc.AllTypesEnum');
        // THEN
        expect(clazz.isClassType()).toBeTruthy();
        expect(iface.isClassType()).toBeFalsy();
        expect(enumt.isClassType()).toBeFalsy();
    });
    test('.isDataType', () => {
        // GIVEN
        const clazz = typesys.findFqn('jsii-calc.AllTypes');
        const iface = typesys.findFqn('jsii-calc.IInterfaceThatShouldNotBeADataType');
        const datat = typesys.findFqn('jsii-calc.CalculatorProps');
        const enumt = typesys.findFqn('jsii-calc.AllTypesEnum');
        // THEN
        expect(clazz.isDataType()).toBeFalsy();
        expect(iface.isDataType()).toBeFalsy();
        expect(datat.isDataType()).toBeTruthy();
        expect(enumt.isDataType()).toBeFalsy();
    });
    test('.isInterfaceType', () => {
        // GIVEN
        const clazz = typesys.findFqn('jsii-calc.AllTypes');
        const iface = typesys.findFqn('jsii-calc.IPublicInterface');
        const enumt = typesys.findFqn('jsii-calc.AllTypesEnum');
        // THEN
        expect(clazz.isInterfaceType()).toBeFalsy();
        expect(iface.isInterfaceType()).toBeTruthy();
        expect(enumt.isInterfaceType()).toBeFalsy();
    });
    test('.isEnumType', () => {
        // GIVEN
        const clazz = typesys.findFqn('jsii-calc.AllTypes');
        const iface = typesys.findFqn('jsii-calc.IPublicInterface');
        const enumt = typesys.findFqn('jsii-calc.AllTypesEnum');
        // THEN
        expect(clazz.isEnumType()).toBeFalsy();
        expect(iface.isEnumType()).toBeFalsy();
        expect(enumt.isEnumType()).toBeTruthy();
    });
    describe('.extends(base)', () => {
        test('with interfaces', () => {
            // GIVEN
            const base = typesys.findFqn('@scope/jsii-calc-base-of-base.VeryBaseProps');
            const clazz = typesys.findFqn('jsii-calc.ImplictBaseOfBase');
            const enumt = typesys.findFqn('jsii-calc.AllTypesEnum');
            // THEN
            expect(base.extends(base)).toBeTruthy();
            expect(clazz.extends(clazz)).toBeTruthy();
            expect(clazz.extends(base)).toBeTruthy();
            expect(enumt.extends(base)).toBeFalsy();
            expect(base.extends(enumt)).toBeFalsy();
            expect(base.extends(clazz)).toBeFalsy();
        });
        test('with a class and an interface', () => {
            // GIVEN
            const iface = typesys.findFqn('jsii-calc.IInterfaceImplementedByAbstractClass');
            const clazz = typesys.findFqn('jsii-calc.AbstractClass');
            // THEN
            expect(clazz.extends(iface)).toBeTruthy();
        });
        test('with two classes', () => {
            // GIVEN
            const base = typesys.findFqn('jsii-calc.AbstractClassBase');
            const clazz = typesys.findFqn('jsii-calc.AbstractClass');
            // THEN
            expect(clazz.extends(base)).toBeTruthy();
        });
    });
    describe('.allImplementations', () => {
        test('with an interface', () => {
            // GIVEN
            const base = typesys.findFqn('jsii-calc.IInterfaceImplementedByAbstractClass');
            // THEN
            expect(base.allImplementations).toEqual([
                typesys.findFqn('jsii-calc.AbstractClass'),
                base,
            ]);
        });
        test('with an enum', () => {
            // GIVEN
            const enumt = typesys.findFqn('jsii-calc.AllTypesEnum');
            // THEN
            expect(enumt.allImplementations).toEqual([]);
        });
    });
});
test('Three Inheritance Levels', () => {
    const iface = typesys.findInterface('@scope/jsii-calc-lib.IThreeLevelsInterface');
    const methodnames = iface.allMethods.map((m) => m.name);
    methodnames.sort();
    expect(methodnames).toEqual(['bar', 'baz', 'foo']);
});
describe('@deprecated', () => {
    test('can be read on an item', () => {
        const klass = typesys.findClass('jsii-calc.Old');
        expect(klass.docs.deprecated).toBeTruthy();
        expect(klass.docs.stability).toBe(spec.Stability.Deprecated);
    });
    test('is inherited from class', () => {
        const klass = typesys.findClass('jsii-calc.Old');
        const method = klass.getMethods().doAThing;
        expect(method.docs.deprecated).toBeTruthy();
    });
});
/**
 * This test is actually testing the combination of `jsii`, `jsii-calc` and `jsii-reflect`.
 */
test('Submodules can have a README', () => {
    var _a, _b;
    const jsiiCalc = typesys.findAssembly('jsii-calc');
    const submodule = jsiiCalc.submodules.find((m) => m.fqn === 'jsii-calc.submodule');
    const isolated = submodule === null || submodule === void 0 ? void 0 : submodule.submodules.find((m) => m.fqn === 'jsii-calc.submodule.isolated');
    expect((_a = submodule === null || submodule === void 0 ? void 0 : submodule.readme) === null || _a === void 0 ? void 0 : _a.markdown).toMatch(/This is the readme.*jsii-calc.submodule/);
    expect((_b = isolated === null || isolated === void 0 ? void 0 : isolated.readme) === null || _b === void 0 ? void 0 : _b.markdown).toMatch(/This is the readme.*jsii-calc.submodule.isolated/);
});
test('overridden member knows about both parent types', async () => {
    const ts = await util_1.typeSystemFromSource(`
    export class Foo {
      public bar() {
        Array.isArray(3);
      }

      public boo(): boolean {
        return true;
      }
    }

    export class SubFoo extends Foo {
      public boo(): boolean {
        return false;
      }
    }
  `);
    const superType = ts.findClass('testpkg.Foo');
    const subType = ts.findClass('testpkg.SubFoo');
    const fooMethod = subType.allMethods.find((m) => m.name === 'bar');
    const booMethod = subType.allMethods.find((m) => m.name === 'boo');
    expect(fooMethod.parentType).toBe(subType);
    expect(fooMethod.definingType).toBe(superType);
    expect(booMethod.parentType).toBe(subType);
    expect(booMethod.definingType).toBe(subType);
    expect(booMethod.overrides).toBe(superType);
});
describe('Stability', () => {
    test('can be read on an item', () => {
        const klass = typesys.findClass('jsii-calc.DocumentedClass');
        expect(klass.docs.stability).toBe(spec.Stability.Stable);
    });
    test('is inherited from class', () => {
        const klass = typesys.findClass('jsii-calc.DocumentedClass');
        const method = klass.getMethods().greet;
        expect(method.docs.stability).toBe(spec.Stability.Stable);
    });
    test('can be overridden from class', () => {
        const klass = typesys.findClass('jsii-calc.DocumentedClass');
        const method = klass.getMethods().hola;
        expect(method.docs.stability).toBe(spec.Stability.Experimental);
    });
    // ----------------------------------------------------------------------
    describe('lowest stability guarantee is advertised', () => {
        test('when subclass is experimental', async () => {
            const ts = await util_1.typeSystemFromSource(`
        /**
         * @stable
         */
        export class Foo {
          constructor() {
            Array.isArray(3);
          }

          public bar() {
            Array.isArray(3);
          }
        }

        /**
         * @experimental
         */
        export class SubFoo extends Foo {
        }
      `);
            const classType = ts.findClass('testpkg.SubFoo');
            const initializer = classType.initializer;
            const method = classType.allMethods.find((m) => m.name === 'bar');
            expect(initializer.docs.stability).toEqual(spec_1.Stability.Experimental);
            expect(method.docs.stability).toEqual(spec_1.Stability.Experimental);
        });
        test('when method is experimental', async () => {
            const ts = await util_1.typeSystemFromSource(`
        /**
         * @stable
         */
        export class Foo {
          /**
           * @experimental
           */
          constructor() {
            Array.isArray(3);
          }

          /**
           * @experimental
           */
          public bar() {
            Array.isArray(3);
          }
        }

        /**
         * @stable
         */
        export class SubFoo extends Foo {
        }
      `);
            const classType = ts.findClass('testpkg.SubFoo');
            const initializer = classType.initializer;
            const method = classType.allMethods.find((m) => m.name === 'bar');
            expect(initializer.docs.stability).toEqual(spec_1.Stability.Experimental);
            expect(method.docs.stability).toEqual(spec_1.Stability.Experimental);
        });
        test('when method is explicitly marked stable', async () => {
            const ts = await util_1.typeSystemFromSource(`
        /**
         * @stable
         */
        export class Foo {
          /**
           * @stable
           */
          constructor() {
            Array.isArray(3);
          }

          /**
           * @stable
           */
          public bar() {
            Array.isArray(3);
          }
        }

        /**
         * @experimental
         */
        export class SubFoo extends Foo {
        }
      `);
            const classType = ts.findClass('testpkg.SubFoo');
            const initializer = classType.initializer;
            const method = classType.allMethods.find((m) => m.name === 'bar');
            expect(initializer.docs.stability).toEqual(spec_1.Stability.Experimental);
            expect(method.docs.stability).toEqual(spec_1.Stability.Experimental);
        });
        test('external stability', async () => {
            const ts = await util_1.typeSystemFromSource(`
        /**
         * @stability external
         */
        export class Foo {
          public bar() {
            Array.isArray(3);
          }
        }

        /**
         * @stable
         */
        export class SubFoo extends Foo {
        }
      `);
            const classType = ts.findClass('testpkg.SubFoo');
            const method = classType.allMethods.find((m) => m.name === 'bar');
            expect(method.docs.stability).toEqual(spec_1.Stability.External);
        });
    });
});
test('TypeSystem.properties', async () => {
    const ts = await util_1.typeSystemFromSource(`
  export namespace submodule {
    export class Foo {
      public readonly test = 'TEST';
    }
    export interface Bar {
      readonly baz: number;
    }
  }
  `);
    expect(ts.properties).toHaveLength(2);
});
test('TypeSystem.methods', async () => {
    const ts = await util_1.typeSystemFromSource(`
  export namespace submodule {
    export class Foo {
      public method(): void {}
    }
    export interface IBar {
      baz(): number;
    }
  }
  `);
    expect(ts.methods).toHaveLength(2);
});
test('Assembly allTypes includes submodule types', async () => {
    const asm = await util_1.assemblyFromSource({
        'index.ts': 'export * as submod from "./submod";',
        'submod.ts': `export class Foo {}`,
    });
    expect(asm.allTypes.map((t) => t.fqn)).toEqual(['testpkg.submod.Foo']);
});
function resolveModuleDir(name) {
    return path.dirname(require.resolve(`${name}/package.json`));
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHlwZS1zeXN0ZW0udGVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInR5cGUtc3lzdGVtLnRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxtQ0FBbUM7QUFDbkMscUNBQXVDO0FBQ3ZDLDZCQUE2QjtBQUU3QixnQ0FBb0M7QUFDcEMsaUNBQWtFO0FBRWxFLElBQUksT0FBbUIsQ0FBQztBQUV4QixTQUFTLENBQUMsS0FBSyxJQUFJLEVBQUU7SUFDbkIsT0FBTyxHQUFHLElBQUksZ0JBQVUsRUFBRSxDQUFDO0lBQzNCLE1BQU0sT0FBTyxDQUFDLFVBQVUsQ0FBQyxnQkFBZ0IsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO0FBQzFELENBQUMsQ0FBQyxDQUFDO0FBRUgsSUFBSSxDQUFDLHdCQUF3QixFQUFFLEdBQUcsRUFBRTtJQUNsQyxNQUFNLENBQUMsT0FBTyxDQUFDLGdCQUFnQixDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsU0FBUyxFQUFFLENBQUM7SUFDekQsTUFBTSxDQUFDLE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDO0lBQzNELE1BQU0sQ0FBQyxPQUFPLENBQUMsZ0JBQWdCLENBQUMsc0JBQXNCLENBQUMsQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDO0FBQ3hFLENBQUMsQ0FBQyxDQUFDO0FBRUgsSUFBSSxDQUFDLHVEQUF1RCxFQUFFLEdBQUcsRUFBRSxDQUNqRSxNQUFNLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLGVBQWUsRUFBRSxDQUFDLENBQUM7QUFFMUUsSUFBSSxDQUFDLDREQUE0RCxFQUFFLEdBQUcsRUFBRSxDQUN0RSxNQUFNLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFD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QUN4QyxDQUFDLENBQUMsQ0FBQztBQUVILElBQUksQ0FBQyxvQkFBb0IsRUFBRSxLQUFLLElBQUksRUFBRTtJQUNwQyxNQUFNLEVBQUUsR0FBRyxNQUFNLDJCQUFvQixDQUFDOzs7Ozs7Ozs7R0FTckMsQ0FBQyxDQUFDO0lBQ0gsTUFBTSxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDckMsQ0FBQyxDQUFDLENBQUM7QUFFSCxJQUFJLENBQUMsNENBQTRDLEVBQUUsS0FBSyxJQUFJLEVBQUU7SUFDNUQsTUFBTSxHQUFHLEdBQUcsTUFBTSx5QkFBa0IsQ0FBQztRQUNuQyxVQUFVLEVBQUUscUNBQXFDO1FBQ2pELFdBQVcsRUFBRSxxQkFBcUI7S0FDbkMsQ0FBQyxDQUFDO0lBRUgsTUFBTSxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLENBQUM7QUFDekUsQ0FBQyxDQUFDLENBQUM7QUFFSCxTQUFTLGdCQUFnQixDQUFDLElBQVk7SUFDcEMsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsR0FBRyxJQUFJLGVBQWUsQ0FBQyxDQUFDLENBQUM7QUFDL0QsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIHNwZWMgZnJvbSAnQGpzaWkvc3BlYyc7XG5pbXBvcnQgeyBTdGFiaWxpdHkgfSBmcm9tICdAanNpaS9zcGVjJztcbmltcG9ydCAqIGFzIHBhdGggZnJvbSAncGF0aCc7XG5cbmltcG9ydCB7IFR5cGVTeXN0ZW0gfSBmcm9tICcuLi9saWInO1xuaW1wb3J0IHsgdHlwZVN5c3RlbUZyb21Tb3VyY2UsIGFzc2VtYmx5RnJvbVNvdXJjZSB9IGZyb20gJy4vdXRpbCc7XG5cbmxldCB0eXBlc3lzOiBUeXBlU3lzdGVtO1xuXG5iZWZvcmVBbGwoYXN5bmMgKCkgPT4ge1xuICB0eXBlc3lzID0gbmV3IFR5cGVTeXN0ZW0oKTtcbiAgYXdhaXQgdHlwZXN5cy5sb2FkTW9kdWxlKHJlc29sdmVNb2R1bGVEaXIoJ2pzaWktY2FsYycpKTtcbn0pO1xuXG50ZXN0KCdUeXBlU3lzdGVtLmhhc0Fzc2VtYmx5JywgKCkgPT4ge1xuICBleHBlY3QodHlwZXN5cy5pbmNsdWRlc0Fzc2VtYmx5KCdAZm9vL2JhcicpKS50b0JlRmFsc3koKTtcbiAgZXhwZWN0KHR5cGVzeXMuaW5jbHVkZXNBc3NlbWJseSgnanNpaS1jYWxjJykpLnRvQmVUcnV0aHkoKTtcbiAgZXhwZWN0KHR5cGVzeXMuaW5jbHVkZXNBc3NlbWJseSgnQHNjb3BlL2pzaWktY2FsYy1saWInKSkudG9CZVRydXRoeSgpO1xufSk7XG5cbnRlc3QoJ1R5cGVTeXN0ZW0uYXNzZW1ibGllcyBsaXN0cyBhbGwgdGhlIGxvYWRlZCBhc3NlbWJsaWVzJywgKCkgPT5cbiAgZXhwZWN0KHR5cGVzeXMuYXNzZW1ibGllcy5tYXAoKGEpID0+IGEubmFtZSkuc29ydCgpKS50b01hdGNoU25hcHNob3QoKSk7XG5cbnRlc3QoJ1R5cGVTeXN0ZW0uY2xhc3NlcyBsaXN0cyBhbGwgdGhlIGNsYXNzZXMgaW4gdGhlIHR5cGVzeXN0ZW0nLCAoKSA9PlxuICBleHBlY3QodHlwZXN5cy5jbGFzc2VzLm1hcCgoYykgPT4gYy5mcW4pLnNvcnQoKSkudG9NYXRjaFNuYXBzaG90KCkpO1xuXG50ZXN0KCdmaW5kQ2xhc3MnLCAoKSA9PiB7XG4gIGNvbnN0IGNhbGMgPSB0eXBlc3lzLmZpbmRDbGFzcygnanNpaS1jYWxjLkNhbGN1bGF0b3InKTtcbiAgY29uc3QgYWN0dWFsID0gbmV3IEFycmF5PHN0cmluZz4oKTtcbiAgT2JqZWN0LnZhbHVlcyhjYWxjLmdldE1ldGhvZHMoLyogaW5oZXJpdGVkICovIHRydWUpKS5mb3JFYWNoKChtZXRob2QpID0+IHtcbiAgICBhY3R1YWwucHVzaChgJHttZXRob2QubmFtZX0gZnJvbSAke21ldGhvZC5wYXJlbnRUeXBlLm5hbWV9YCk7XG4gIH0pO1xuXG4gIGV4cGVjdChhY3R1YWwuam9pbignXFxuJykpLnRvTWF0Y2hTbmFwc2hvdCgpO1xufSk7XG5cbnRlc3QoJ1wicm9vdHNcIiBpcyBhIGxpc3Qgb2YgdGhlIGRpcmVjdGx5IGxvYWRlZCBhc3NlbWJsaWVzJywgYXN5bmMgKCkgPT4ge1xuICBleHBlY3QodHlwZXN5cy5yb290cy5sZW5ndGgpLnRvQmUoMSk7XG4gIGV4cGVjdCh0eXBlc3lzLnJvb3RzWzBdKS50b0JlKHR5cGVzeXMuZmluZEFzc2VtYmx5KCdqc2lpLWNhbGMnKSk7XG5cbiAgLy8gbm93IGxvYWQgYW5vdGhlciBhc3NlbWJsaXkgZGlyZWN0bHlcbiAgYXdhaXQgdHlwZXN5cy5sb2FkKHJlc29sdmVNb2R1bGVEaXIoJ0BzY29wZS9qc2lpLWNhbGMtbGliJykpO1xuICByZXR1cm4gZXhwZWN0KHR5cGVzeXMucm9vdHMubGVuZ3RoKS50b0JlKDIpO1xufSk7XG5cbmRlc2NyaWJlKCdUeXBlJywgKCkgPT4ge1xuICB0ZXN0KCcuaXNDbGFzc1R5cGUnLCAoKSA9PiB7XG4gICAgLy8gR0lWRU5cbiAgICBjb25zdCBjbGF6eiA9IHR5cGVzeXMuZmluZEZxbignanNpaS1jYWxjLkFsbFR5cGVzJyk7XG4gICAgY29uc3QgaWZhY2UgPSB0eXBlc3lzLmZpbmRGcW4oJ2pzaWktY2FsYy5JUHVibGljSW50ZXJmYWNlJyk7XG4gICAgY29uc3QgZW51bXQgPSB0eXBlc3lzLmZpbmRGcW4oJ2pzaWktY2FsYy5BbGxUeXBlc0VudW0nKTtcblxuICAgIC8vIFRIRU5cbiAgICBleHBlY3QoY2xhenouaXNDbGFzc1R5cGUoKSkudG9CZVRydXRoeSgpO1xuICAgIGV4cGVjdChpZmFjZS5pc0NsYXNzVHlwZSgpKS50b0JlRmFsc3koKTtcbiAgICBleHBlY3QoZW51bXQuaXNDbGFzc1R5cGUoKSkudG9CZUZhbHN5KCk7XG4gIH0pO1xuXG4gIHRlc3QoJy5pc0RhdGFUeXBlJywgKCkgPT4ge1xuICAgIC8vIEdJVkVOXG4gICAgY29uc3QgY2xhenogPSB0eXBlc3lzLmZpbmRGcW4oJ2pzaWktY2FsYy5BbGxUeXBlcycpO1xuICAgIGNvbnN0IGlmYWNlID0gdHlwZXN5cy5maW5kRnFuKFxuICAgICAgJ2pzaWktY2FsYy5JSW50ZXJmYWNlVGhhdFNob3VsZE5vdEJlQURhdGFUeXBlJyxcbiAgICApO1xuICAgIGNvbnN0IGRhdGF0ID0gdHlwZXN5cy5maW5kRnFuKCdqc2lpLWNhbGMuQ2FsY3VsYXRvclByb3BzJyk7XG4gICAgY29uc3QgZW51bXQgPSB0eXBlc3lzLmZpbmRGcW4oJ2pzaWktY2FsYy5BbGxUeXBlc0VudW0nKTtcblxuICAgIC8vIFRIRU5cbiAgICBleHBlY3QoY2xhenouaXNEYXRhVHlwZSgpKS50b0JlRmFsc3koKTtcbiAgICBleHBlY3QoaWZhY2UuaXNEYXRhVHlwZSgpKS50b0JlRmFsc3koKTtcbiAgICBleHBlY3QoZGF0YXQuaXNEYXRhVHlwZSgpKS50b0JlVHJ1dGh5KCk7XG4gICAgZXhwZWN0KGVudW10LmlzRGF0YVR5cGUoKSkudG9CZUZhbHN5KCk7XG4gIH0pO1xuXG4gIHRlc3QoJy5pc0ludGVyZmFjZVR5cGUnLCAoKSA9PiB7XG4gICAgLy8gR0lWRU5cbiAgICBjb25zdCBjbGF6eiA9IHR5cGVzeXMuZmluZEZxbignanNpaS1jYWxjLkFsbFR5cGVzJyk7XG4gICAgY29uc3QgaWZhY2UgPSB0eXBlc3lzLmZpbmRGcW4oJ2pzaWktY2FsYy5JUHVibGljSW50ZXJmYWNlJyk7XG4gICAgY29uc3QgZW51bXQgPSB0eXBlc3lzLmZpbmRGcW4oJ2pzaWktY2FsYy5BbGxUeXBlc0VudW0nKTtcblxuICAgIC8vIFRIRU5cbiAgICBleHBlY3QoY2xhenouaXNJbnRlcmZhY2VUeXBlKCkpLnRvQmVGYWxzeSgpO1xuICAgIGV4cGVjdChpZmFjZS5pc0ludGVyZmFjZVR5cGUoKSkudG9CZVRydXRoeSgpO1xuICAgIGV4cGVjdChlbnVtdC5pc0ludGVyZmFjZVR5cGUoKSkudG9CZUZhbHN5KCk7XG4gIH0pO1xuXG4gIHRlc3QoJy5pc0VudW1UeXBlJywgKCkgPT4ge1xuICAgIC8vIEdJVkVOXG4gICAgY29uc3QgY2xhenogPSB0eXBlc3lzLmZpbmRGcW4oJ2pzaWktY2FsYy5BbGxUeXBlcycpO1xuICAgIGNvbnN0IGlmYWNlID0gdHlwZXN5cy5maW5kRnFuKCdqc2lpLWNhbGMuSVB1YmxpY0ludGVyZmFjZScpO1xuICAgIGNvbnN0IGVudW10ID0gdHlwZXN5cy5maW5kRnFuKCdqc2lpLWNhbGMuQWxsVHlwZXNFbnVtJyk7XG5cbiAgICAvLyBUSEVOXG4gICAgZXhwZWN0KGNsYXp6LmlzRW51bVR5cGUoKSkudG9CZUZhbHN5KCk7XG4gICAgZXhwZWN0KGlmYWNlLmlzRW51bVR5cGUoKSkudG9CZUZhbHN5KCk7XG4gICAgZXhwZWN0KGVudW10LmlzRW51bVR5cGUoKSkudG9CZVRydXRoeSgpO1xuICB9KTtcblxuICBkZXNjcmliZSgnLmV4dGVuZHMoYmFzZSknLCAoKSA9PiB7XG4gICAgdGVzdCgnd2l0aCBpbnRlcmZhY2VzJywgKCkgPT4ge1xuICAgICAgLy8gR0lWRU5cbiAgICAgIGNvbnN0IGJhc2UgPSB0eXBlc3lzLmZpbmRGcW4oXG4gICAgICAgICdAc2NvcGUvanNpaS1jYWxjLWJhc2Utb2YtYmFzZS5WZXJ5QmFzZVByb3BzJyxcbiAgICAgICk7XG4gICAgICBjb25zdCBjbGF6eiA9IHR5cGVzeXMuZmluZEZxbignanNpaS1jYWxjLkltcGxpY3RCYXNlT2ZCYXNlJyk7XG4gICAgICBjb25zdCBlbnVtdCA9IHR5cGVzeXMuZmluZEZxbignanNpaS1jYWxjLkFsbFR5cGVzRW51bScpO1xuXG4gICAgICAvLyBUSEVOXG4gICAgICBleHBlY3QoYmFzZS5leHRlbmRzKGJhc2UpKS50b0JlVHJ1dGh5KCk7XG4gICAgICBleHBlY3QoY2xhenouZXh0ZW5kcyhjbGF6eikpLnRvQmVUcnV0aHkoKTtcbiAgICAgIGV4cGVjdChjbGF6ei5leHRlbmRzKGJhc2UpKS50b0JlVHJ1dGh5KCk7XG4gICAgICBleHBlY3QoZW51bXQuZXh0ZW5kcyhiYXNlKSkudG9CZUZhbHN5KCk7XG4gICAgICBleHBlY3QoYmFzZS5leHRlbmRzKGVudW10KSkudG9CZUZhbHN5KCk7XG4gICAgICBleHBlY3QoYmFzZS5leHRlbmRzKGNsYXp6KSkudG9CZUZhbHN5KCk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCd3aXRoIGEgY2xhc3MgYW5kIGFuIGludGVyZmFjZScsICgpID0+IHtcbiAgICAgIC8vIEdJVkVOXG4gICAgICBjb25zdCBpZmFjZSA9IHR5cGVzeXMuZmluZEZxbihcbiAgICAgICAgJ2pzaWktY2FsYy5JSW50ZXJmYWNlSW1wbGVtZW50ZWRCeUFic3RyYWN0Q2xhc3MnLFxuICAgICAgKTtcbiAgICAgIGNvbnN0IGNsYXp6ID0gdHlwZXN5cy5maW5kRnFuKCdqc2lpLWNhbGMuQWJzdHJhY3RDbGFzcycpO1xuXG4gICAgICAvLyBUSEVOXG4gICAgICBleHBlY3QoY2xhenouZXh0ZW5kcyhpZmFjZSkpLnRvQmVUcnV0aHkoKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3dpdGggdHdvIGNsYXNzZXMnLCAoKSA9PiB7XG4gICAgICAvLyBHSVZFTlxuICAgICAgY29uc3QgYmFzZSA9IHR5cGVzeXMuZmluZEZxbignanNpaS1jYWxjLkFic3RyYWN0Q2xhc3NCYXNlJyk7XG4gICAgICBjb25zdCBjbGF6eiA9IHR5cGVzeXMuZmluZEZxbignanNpaS1jYWxjLkFic3RyYWN0Q2xhc3MnKTtcblxuICAgICAgLy8gVEhFTlxuICAgICAgZXhwZWN0KGNsYXp6LmV4dGVuZHMoYmFzZSkpLnRvQmVUcnV0aHkoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJy5hbGxJbXBsZW1lbnRhdGlvbnMnLCAoKSA9PiB7XG4gICAgdGVzdCgnd2l0aCBhbiBpbnRlcmZhY2UnLCAoKSA9PiB7XG4gICAgICAvLyBHSVZFTlxuICAgICAgY29uc3QgYmFzZSA9IHR5cGVzeXMuZmluZEZxbihcbiAgICAgICAgJ2pzaWktY2FsYy5JSW50ZXJmYWNlSW1wbGVtZW50ZWRCeUFic3RyYWN0Q2xhc3MnLFxuICAgICAgKTtcblxuICAgICAgLy8gVEhFTlxuICAgICAgZXhwZWN0KGJhc2UuYWxsSW1wbGVtZW50YXRpb25zKS50b0VxdWFsKFtcbiAgICAgICAgdHlwZXN5cy5maW5kRnFuKCdqc2lpLWNhbGMuQWJzdHJhY3RDbGFzcycpLFxuICAgICAgICBiYXNlLFxuICAgICAgXSk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCd3aXRoIGFuIGVudW0nLCAoKSA9PiB7XG4gICAgICAvLyBHSVZFTlxuICAgICAgY29uc3QgZW51bXQgPSB0eXBlc3lzLmZpbmRGcW4oJ2pzaWktY2FsYy5BbGxUeXBlc0VudW0nKTtcblxuICAgICAgLy8gVEhFTlxuICAgICAgZXhwZWN0KGVudW10LmFsbEltcGxlbWVudGF0aW9ucykudG9FcXVhbChbXSk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG5cbnRlc3QoJ1RocmVlIEluaGVyaXRhbmNlIExldmVscycsICgpID0+IHtcbiAgY29uc3QgaWZhY2UgPSB0eXBlc3lzLmZpbmRJbnRlcmZhY2UoXG4gICAgJ0BzY29wZS9qc2lpLWNhbGMtbGliLklUaHJlZUxldmVsc0ludGVyZmFjZScsXG4gICk7XG4gIGNvbnN0IG1ldGhvZG5hbWVzID0gaWZhY2UuYWxsTWV0aG9kcy5tYXAoKG0pID0+IG0ubmFtZSk7XG4gIG1ldGhvZG5hbWVzLnNvcnQoKTtcbiAgZXhwZWN0KG1ldGhvZG5hbWVzKS50b0VxdWFsKFsnYmFyJywgJ2JheicsICdmb28nXSk7XG59KTtcblxuZGVzY3JpYmUoJ0BkZXByZWNhdGVkJywgKCkgPT4ge1xuICB0ZXN0KCdjYW4gYmUgcmVhZCBvbiBhbiBpdGVtJywgKCkgPT4ge1xuICAgIGNvbnN0IGtsYXNzID0gdHlwZXN5cy5maW5kQ2xhc3MoJ2pzaWktY2FsYy5PbGQnKTtcbiAgICBleHBlY3Qoa2xhc3MuZG9jcy5kZXByZWNhdGVkKS50b0JlVHJ1dGh5KCk7XG4gICAgZXhwZWN0KGtsYXNzLmRvY3Muc3RhYmlsaXR5KS50b0JlKHNwZWMuU3RhYmlsaXR5LkRlcHJlY2F0ZWQpO1xuICB9KTtcblxuICB0ZXN0KCdpcyBpbmhlcml0ZWQgZnJvbSBjbGFzcycsICgpID0+IHtcbiAgICBjb25zdCBrbGFzcyA9IHR5cGVzeXMuZmluZENsYXNzKCdqc2lpLWNhbGMuT2xkJyk7XG4gICAgY29uc3QgbWV0aG9kID0ga2xhc3MuZ2V0TWV0aG9kcygpLmRvQVRoaW5nO1xuICAgIGV4cGVjdChtZXRob2QuZG9jcy5kZXByZWNhdGVkKS50b0JlVHJ1dGh5KCk7XG4gIH0pO1xufSk7XG5cbi8qKlxuICogVGhpcyB0ZXN0IGlzIGFjdHVhbGx5IHRlc3RpbmcgdGhlIGNvbWJpbmF0aW9uIG9mIGBqc2lpYCwgYGpzaWktY2FsY2AgYW5kIGBqc2lpLXJlZmxlY3RgLlxuICovXG50ZXN0KCdTdWJtb2R1bGVzIGNhbiBoYXZlIGEgUkVBRE1FJywgKCkgPT4ge1xuICBjb25zdCBqc2lpQ2FsYyA9IHR5cGVzeXMuZmluZEFzc2VtYmx5KCdqc2lpLWNhbGMnKTtcblxuICBjb25zdCBzdWJtb2R1bGUgPSBqc2lpQ2FsYy5zdWJtb2R1bGVzLmZpbmQoXG4gICAgKG0pID0+IG0uZnFuID09PSAnanNpaS1jYWxjLnN1Ym1vZHVsZScsXG4gICk7XG4gIGNvbnN0IGlzb2xhdGVkID0gc3VibW9kdWxlPy5zdWJtb2R1bGVzLmZpbmQoXG4gICAgKG0pID0+IG0uZnFuID09PSAnanNpaS1jYWxjLnN1Ym1vZHVsZS5pc29sYXRlZCcsXG4gICk7XG5cbiAgZXhwZWN0KHN1Ym1vZHVsZT8ucmVhZG1lPy5tYXJrZG93bikudG9NYXRjaChcbiAgICAvVGhpcyBpcyB0aGUgcmVhZG1lLipqc2lpLWNhbGMuc3VibW9kdWxlLyxcbiAgKTtcbiAgZXhwZWN0KGlzb2xhdGVkPy5yZWFkbWU/Lm1hcmtkb3duKS50b01hdGNoKFxuICAgIC9UaGlzIGlzIHRoZSByZWFkbWUuKmpzaWktY2FsYy5zdWJtb2R1bGUuaXNvbGF0ZWQvLFxuICApO1xufSk7XG5cbnRlc3QoJ292ZXJyaWRkZW4gbWVtYmVyIGtub3dzIGFib3V0IGJvdGggcGFyZW50IHR5cGVzJywgYXN5bmMgKCkgPT4ge1xuICBjb25zdCB0cyA9IGF3YWl0IHR5cGVTeXN0ZW1Gcm9tU291cmNlKGBcbiAgICBleHBvcnQgY2xhc3MgRm9vIHtcbiAgICAgIHB1YmxpYyBiYXIoKSB7XG4gICAgICAgIEFycmF5LmlzQXJyYXkoMyk7XG4gICAgICB9XG5cbiAgICAgIHB1YmxpYyBib28oKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIGV4cG9ydCBjbGFzcyBTdWJGb28gZXh0ZW5kcyBGb28ge1xuICAgICAgcHVibGljIGJvbygpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgYCk7XG5cbiAgY29uc3Qgc3VwZXJUeXBlID0gdHMuZmluZENsYXNzKCd0ZXN0cGtnLkZvbycpO1xuICBjb25zdCBzdWJUeXBlID0gdHMuZmluZENsYXNzKCd0ZXN0cGtnLlN1YkZvbycpO1xuICBjb25zdCBmb29NZXRob2QgPSBzdWJUeXBlLmFsbE1ldGhvZHMuZmluZCgobSkgPT4gbS5uYW1lID09PSAnYmFyJykhO1xuICBjb25zdCBib29NZXRob2QgPSBzdWJUeXBlLmFsbE1ldGhvZHMuZmluZCgobSkgPT4gbS5uYW1lID09PSAnYm9vJykhO1xuXG4gIGV4cGVjdChmb29NZXRob2QucGFyZW50VHlwZSkudG9CZShzdWJUeXBlKTtcbiAgZXhwZWN0KGZvb01ldGhvZC5kZWZpbmluZ1R5cGUpLnRvQmUoc3VwZXJUeXBlKTtcblxuICBleHBlY3QoYm9vTWV0aG9kLnBhcmVudFR5cGUpLnRvQmUoc3ViVHlwZSk7XG4gIGV4cGVjdChib29NZXRob2QuZGVmaW5pbmdUeXBlKS50b0JlKHN1YlR5cGUpO1xuICBleHBlY3QoYm9vTWV0aG9kLm92ZXJyaWRlcykudG9CZShzdXBlclR5cGUpO1xufSk7XG5cbmRlc2NyaWJlKCdTdGFiaWxpdHknLCAoKSA9PiB7XG4gIHRlc3QoJ2NhbiBiZSByZWFkIG9uIGFuIGl0ZW0nLCAoKSA9PiB7XG4gICAgY29uc3Qga2xhc3MgPSB0eXBlc3lzLmZpbmRDbGFzcygnanNpaS1jYWxjLkRvY3VtZW50ZWRDbGFzcycpO1xuICAgIGV4cGVjdChrbGFzcy5kb2NzLnN0YWJpbGl0eSkudG9CZShzcGVjLlN0YWJpbGl0eS5TdGFibGUpO1xuICB9KTtcblxuICB0ZXN0KCdpcyBpbmhlcml0ZWQgZnJvbSBjbGFzcycsICgpID0+IHtcbiAgICBjb25zdCBrbGFzcyA9IHR5cGVzeXMuZmluZENsYXNzKCdqc2lpLWNhbGMuRG9jdW1lbnRlZENsYXNzJyk7XG4gICAgY29uc3QgbWV0aG9kID0ga2xhc3MuZ2V0TWV0aG9kcygpLmdyZWV0O1xuICAgIGV4cGVjdChtZXRob2QuZG9jcy5zdGFiaWxpdHkpLnRvQmUoc3BlYy5TdGFiaWxpdHkuU3RhYmxlKTtcbiAgfSk7XG5cbiAgdGVzdCgnY2FuIGJlIG92ZXJyaWRkZW4gZnJvbSBjbGFzcycsICgpID0+IHtcbiAgICBjb25zdCBrbGFzcyA9IHR5cGVzeXMuZmluZENsYXNzKCdqc2lpLWNhbGMuRG9jdW1lbnRlZENsYXNzJyk7XG4gICAgY29uc3QgbWV0aG9kID0ga2xhc3MuZ2V0TWV0aG9kcygpLmhvbGE7XG4gICAgZXhwZWN0KG1ldGhvZC5kb2NzLnN0YWJpbGl0eSkudG9CZShzcGVjLlN0YWJpbGl0eS5FeHBlcmltZW50YWwpO1xuICB9KTtcblxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgZGVzY3JpYmUoJ2xvd2VzdCBzdGFiaWxpdHkgZ3VhcmFudGVlIGlzIGFkdmVydGlzZWQnLCAoKSA9PiB7XG4gICAgdGVzdCgnd2hlbiBzdWJjbGFzcyBpcyBleHBlcmltZW50YWwnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB0cyA9IGF3YWl0IHR5cGVTeXN0ZW1Gcm9tU291cmNlKGBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBzdGFibGVcbiAgICAgICAgICovXG4gICAgICAgIGV4cG9ydCBjbGFzcyBGb28ge1xuICAgICAgICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAgICAgQXJyYXkuaXNBcnJheSgzKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBwdWJsaWMgYmFyKCkge1xuICAgICAgICAgICAgQXJyYXkuaXNBcnJheSgzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQGV4cGVyaW1lbnRhbFxuICAgICAgICAgKi9cbiAgICAgICAgZXhwb3J0IGNsYXNzIFN1YkZvbyBleHRlbmRzIEZvbyB7XG4gICAgICAgIH1cbiAgICAgIGApO1xuICAgICAgY29uc3QgY2xhc3NUeXBlID0gdHMuZmluZENsYXNzKCd0ZXN0cGtnLlN1YkZvbycpO1xuICAgICAgY29uc3QgaW5pdGlhbGl6ZXIgPSBjbGFzc1R5cGUuaW5pdGlhbGl6ZXIhO1xuICAgICAgY29uc3QgbWV0aG9kID0gY2xhc3NUeXBlLmFsbE1ldGhvZHMuZmluZCgobSkgPT4gbS5uYW1lID09PSAnYmFyJykhO1xuXG4gICAgICBleHBlY3QoaW5pdGlhbGl6ZXIuZG9jcy5zdGFiaWxpdHkpLnRvRXF1YWwoU3RhYmlsaXR5LkV4cGVyaW1lbnRhbCk7XG4gICAgICBleHBlY3QobWV0aG9kLmRvY3Muc3RhYmlsaXR5KS50b0VxdWFsKFN0YWJpbGl0eS5FeHBlcmltZW50YWwpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnd2hlbiBtZXRob2QgaXMgZXhwZXJpbWVudGFsJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdHMgPSBhd2FpdCB0eXBlU3lzdGVtRnJvbVNvdXJjZShgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAc3RhYmxlXG4gICAgICAgICAqL1xuICAgICAgICBleHBvcnQgY2xhc3MgRm9vIHtcbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBAZXhwZXJpbWVudGFsXG4gICAgICAgICAgICovXG4gICAgICAgICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgICAgICBBcnJheS5pc0FycmF5KDMpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIEBleHBlcmltZW50YWxcbiAgICAgICAgICAgKi9cbiAgICAgICAgICBwdWJsaWMgYmFyKCkge1xuICAgICAgICAgICAgQXJyYXkuaXNBcnJheSgzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQHN0YWJsZVxuICAgICAgICAgKi9cbiAgICAgICAgZXhwb3J0IGNsYXNzIFN1YkZvbyBleHRlbmRzIEZvbyB7XG4gICAgICAgIH1cbiAgICAgIGApO1xuXG4gICAgICBjb25zdCBjbGFzc1R5cGUgPSB0cy5maW5kQ2xhc3MoJ3Rlc3Rwa2cuU3ViRm9vJyk7XG4gICAgICBjb25zdCBpbml0aWFsaXplciA9IGNsYXNzVHlwZS5pbml0aWFsaXplciE7XG4gICAgICBjb25zdCBtZXRob2QgPSBjbGFzc1R5cGUuYWxsTWV0aG9kcy5maW5kKChtKSA9PiBtLm5hbWUgPT09ICdiYXInKSE7XG5cbiAgICAgIGV4cGVjdChpbml0aWFsaXplci5kb2NzLnN0YWJpbGl0eSkudG9FcXVhbChTdGFiaWxpdHkuRXhwZXJpbWVudGFsKTtcbiAgICAgIGV4cGVjdChtZXRob2QuZG9jcy5zdGFiaWxpdHkpLnRvRXF1YWwoU3RhYmlsaXR5LkV4cGVyaW1lbnRhbCk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCd3aGVuIG1ldGhvZCBpcyBleHBsaWNpdGx5IG1hcmtlZCBzdGFibGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB0cyA9IGF3YWl0IHR5cGVTeXN0ZW1Gcm9tU291cmNlKGBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBzdGFibGVcbiAgICAgICAgICovXG4gICAgICAgIGV4cG9ydCBjbGFzcyBGb28ge1xuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIEBzdGFibGVcbiAgICAgICAgICAgKi9cbiAgICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICAgIEFycmF5LmlzQXJyYXkoMyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLyoqXG4gICAgICAgICAgICogQHN0YWJsZVxuICAgICAgICAgICAqL1xuICAgICAgICAgIHB1YmxpYyBiYXIoKSB7XG4gICAgICAgICAgICBBcnJheS5pc0FycmF5KDMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAZXhwZXJpbWVudGFsXG4gICAgICAgICAqL1xuICAgICAgICBleHBvcnQgY2xhc3MgU3ViRm9vIGV4dGVuZHMgRm9vIHtcbiAgICAgICAgfVxuICAgICAgYCk7XG5cbiAgICAgIGNvbnN0IGNsYXNzVHlwZSA9IHRzLmZpbmRDbGFzcygndGVzdHBrZy5TdWJGb28nKTtcbiAgICAgIGNvbnN0IGluaXRpYWxpemVyID0gY2xhc3NUeXBlLmluaXRpYWxpemVyITtcbiAgICAgIGNvbnN0IG1ldGhvZCA9IGNsYXNzVHlwZS5hbGxNZXRob2RzLmZpbmQoKG0pID0+IG0ubmFtZSA9PT0gJ2JhcicpITtcblxuICAgICAgZXhwZWN0KGluaXRpYWxpemVyLmRvY3Muc3RhYmlsaXR5KS50b0VxdWFsKFN0YWJpbGl0eS5FeHBlcmltZW50YWwpO1xuICAgICAgZXhwZWN0KG1ldGhvZC5kb2NzLnN0YWJpbGl0eSkudG9FcXVhbChTdGFiaWxpdHkuRXhwZXJpbWVudGFsKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ2V4dGVybmFsIHN0YWJpbGl0eScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRzID0gYXdhaXQgdHlwZVN5c3RlbUZyb21Tb3VyY2UoYFxuICAgICAgICAvKipcbiAgICAgICAgICogQHN0YWJpbGl0eSBleHRlcm5hbFxuICAgICAgICAgKi9cbiAgICAgICAgZXhwb3J0IGNsYXNzIEZvbyB7XG4gICAgICAgICAgcHVibGljIGJhcigpIHtcbiAgICAgICAgICAgIEFycmF5LmlzQXJyYXkoMyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBzdGFibGVcbiAgICAgICAgICovXG4gICAgICAgIGV4cG9ydCBjbGFzcyBTdWJGb28gZXh0ZW5kcyBGb28ge1xuICAgICAgICB9XG4gICAgICBgKTtcblxuICAgICAgY29uc3QgY2xhc3NUeXBlID0gdHMuZmluZENsYXNzKCd0ZXN0cGtnLlN1YkZvbycpO1xuICAgICAgY29uc3QgbWV0aG9kID0gY2xhc3NUeXBlLmFsbE1ldGhvZHMuZmluZCgobSkgPT4gbS5uYW1lID09PSAnYmFyJykhO1xuXG4gICAgICBleHBlY3QobWV0aG9kLmRvY3Muc3RhYmlsaXR5KS50b0VxdWFsKFN0YWJpbGl0eS5FeHRlcm5hbCk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG5cbnRlc3QoJ1R5cGVTeXN0ZW0ucHJvcGVydGllcycsIGFzeW5jICgpID0+IHtcbiAgY29uc3QgdHMgPSBhd2FpdCB0eXBlU3lzdGVtRnJvbVNvdXJjZShgXG4gIGV4cG9ydCBuYW1lc3BhY2Ugc3VibW9kdWxlIHtcbiAgICBleHBvcnQgY2xhc3MgRm9vIHtcbiAgICAgIHB1YmxpYyByZWFkb25seSB0ZXN0ID0gJ1RFU1QnO1xuICAgIH1cbiAgICBleHBvcnQgaW50ZXJmYWNlIEJhciB7XG4gICAgICByZWFkb25seSBiYXo6IG51bWJlcjtcbiAgICB9XG4gIH1cbiAgYCk7XG4gIGV4cGVjdCh0cy5wcm9wZXJ0aWVzKS50b0hhdmVMZW5ndGgoMik7XG59KTtcblxudGVzdCgnVHlwZVN5c3RlbS5tZXRob2RzJywgYXN5bmMgKCkgPT4ge1xuICBjb25zdCB0cyA9IGF3YWl0IHR5cGVTeXN0ZW1Gcm9tU291cmNlKGBcbiAgZXhwb3J0IG5hbWVzcGFjZSBzdWJtb2R1bGUge1xuICAgIGV4cG9ydCBjbGFzcyBGb28ge1xuICAgICAgcHVibGljIG1ldGhvZCgpOiB2b2lkIHt9XG4gICAgfVxuICAgIGV4cG9ydCBpbnRlcmZhY2UgSUJhciB7XG4gICAgICBiYXooKTogbnVtYmVyO1xuICAgIH1cbiAgfVxuICBgKTtcbiAgZXhwZWN0KHRzLm1ldGhvZHMpLnRvSGF2ZUxlbmd0aCgyKTtcbn0pO1xuXG50ZXN0KCdBc3NlbWJseSBhbGxUeXBlcyBpbmNsdWRlcyBzdWJtb2R1bGUgdHlwZXMnLCBhc3luYyAoKSA9PiB7XG4gIGNvbnN0IGFzbSA9IGF3YWl0IGFzc2VtYmx5RnJvbVNvdXJjZSh7XG4gICAgJ2luZGV4LnRzJzogJ2V4cG9ydCAqIGFzIHN1Ym1vZCBmcm9tIFwiLi9zdWJtb2RcIjsnLFxuICAgICdzdWJtb2QudHMnOiBgZXhwb3J0IGNsYXNzIEZvbyB7fWAsXG4gIH0pO1xuXG4gIGV4cGVjdChhc20uYWxsVHlwZXMubWFwKCh0KSA9PiB0LmZxbikpLnRvRXF1YWwoWyd0ZXN0cGtnLnN1Ym1vZC5Gb28nXSk7XG59KTtcblxuZnVuY3Rpb24gcmVzb2x2ZU1vZHVsZURpcihuYW1lOiBzdHJpbmcpIHtcbiAgcmV0dXJuIHBhdGguZGlybmFtZShyZXF1aXJlLnJlc29sdmUoYCR7bmFtZX0vcGFja2FnZS5qc29uYCkpO1xufVxuIl19